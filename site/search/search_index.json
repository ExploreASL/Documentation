{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"ExploreASL Description ExploreASL is a pipeline and toolbox for image processing and statistics of arterial spin labeling perfusion MR images. It is designed as a multi-OS , open source, collaborative framework that facilitates cross-pollination between image processing method developers and clinical investigators. The software provides a complete head-to-tail approach that runs fully automatically, encompassing all necessary tasks from data import and structural segmentation, registration and normalization, up to CBF quantification. In addition, the software package includes and quality control ( QC ) procedures and region-of-interest ( ROI ) as well as voxel-wise analysis on the extracted data. To-date, ExploreASL has been used for processing ~10000 ASL datasets from all major MRI vendors and ASL sequences, and a variety of patient populations, representing ~30 studies. The ultimate goal of ExploreASL is to combine data from multiple studies to identify disease related perfusion patterns that may prove crucial in using ASL as a diagnostic took and enhance our understanding of the interplay of perfusion and structural changes in neurodegenerative pathophysiology. Additionally, this (semi-)automatic pipeline allows us to minimize manual intervention, which increases the reproducibility of studies. Highlighted Features Features Installation To use ExploreASL within Matlab, you can download a stable release version from the GitHub releases section. Navigate within Matlab to the ExporeASL directory, to make ExploreASL the current working directory. It is recommended to use the Matlab set paths option to add the ExploreASL folder and all subfolders to the known paths. Execute the master script to start the interactive ExploreASL workflow: ExploreASL_Master Workflow Developers Please contact the co-creators for more information: Henk-Jan Mutsaerts HenkJanMutsaerts@Gmail.com Jan Petr j.petr@hzdr.de Other Contributors Acknowledgement","title":"Home"},{"location":"#exploreasl","text":"","title":"ExploreASL"},{"location":"#description","text":"ExploreASL is a pipeline and toolbox for image processing and statistics of arterial spin labeling perfusion MR images. It is designed as a multi-OS , open source, collaborative framework that facilitates cross-pollination between image processing method developers and clinical investigators. The software provides a complete head-to-tail approach that runs fully automatically, encompassing all necessary tasks from data import and structural segmentation, registration and normalization, up to CBF quantification. In addition, the software package includes and quality control ( QC ) procedures and region-of-interest ( ROI ) as well as voxel-wise analysis on the extracted data. To-date, ExploreASL has been used for processing ~10000 ASL datasets from all major MRI vendors and ASL sequences, and a variety of patient populations, representing ~30 studies. The ultimate goal of ExploreASL is to combine data from multiple studies to identify disease related perfusion patterns that may prove crucial in using ASL as a diagnostic took and enhance our understanding of the interplay of perfusion and structural changes in neurodegenerative pathophysiology. Additionally, this (semi-)automatic pipeline allows us to minimize manual intervention, which increases the reproducibility of studies.","title":"Description"},{"location":"#highlighted-features","text":"","title":"Highlighted Features"},{"location":"#features","text":"","title":"Features"},{"location":"#installation","text":"To use ExploreASL within Matlab, you can download a stable release version from the GitHub releases section. Navigate within Matlab to the ExporeASL directory, to make ExploreASL the current working directory. It is recommended to use the Matlab set paths option to add the ExploreASL folder and all subfolders to the known paths. Execute the master script to start the interactive ExploreASL workflow: ExploreASL_Master","title":"Installation"},{"location":"#workflow","text":"","title":"Workflow"},{"location":"#developers","text":"Please contact the co-creators for more information: Henk-Jan Mutsaerts HenkJanMutsaerts@Gmail.com Jan Petr j.petr@hzdr.de","title":"Developers"},{"location":"#other-contributors","text":"","title":"Other Contributors"},{"location":"#acknowledgement","text":"","title":"Acknowledgement"},{"location":"ASL_Module/","text":"Submodules of the ASL Module Create Analysis Mask Function function xASL_wrp_CreateAnalysisMask(x) Description Create analysis mask from a combination of FoV & removal of high and negative intravascular ASL voxels. Workflow Create FoV mask (native & MNI spaces) Detect negative vascular signal (native & MNI spaces, within pGM >0.5) Detect peak vascular signal (native & MNI spaces, within pGM ==80% percentile on ASL image) Brainmasking & FoV -masking (A) native & B) MNI spaces): Add WM vascular parts back to the mask (defined as pWM>0.8) & remove extracranial signal. In the WM , negative or peak signal is more expected from noise rather than from intra-vascular signal, not many big vessels exist in the WM . Save vascular masks Create susceptibility mask (standard space only): Here, we combine manually segmented susceptibility artifact regions in which a population-based susceptibility probability map is created. This map is combined (i.e. taking the product) with the mean control & PWI intensity distribution in these regions. This product is thresholded with the average of the 75th percentile & 15% of the intensity (for a bit more robustness against individual variability in sinus sizes). Create standard space CBF_masked image to visualize masking effect Recommended usage Interface definition Prepare PV Function function x = xASL_wrp_PreparePV(x, bStandardSpace) Description Submodule of ExploreASL ASL Module, to prepare PV maps on ASL resolution. Workflow This submodule prepares partial volume correction ( PVC ) by creating correct PV maps in ASL resolution, in native space, as well as in standard space if requested (to perform PVC in standard space). If bStandardSpace: 1. Create dummy upsampled ASL scan, for registration 2. Reslice pGM & pWM to hi-res ASL 3. Estimate effective spatial resolution of ASL 4. Smooth pGM & pWM to this spatial resolution 5. Move smoothed tissue posteriors to MNI space Else: Run step 3 only, which will use the effective spatial resolution that is default for the respective sequence: 2D EPI : [1 1 1] * VoxelSize 3D GRASE : [1.1 1.1 1.38] * VoxelSize 3D spiral : [4.3 4.4 10.1] * VoxelSize (assuming GE uses the upsampled 2x2x4 mm ...& run steps 1&2, but in native space these entail presmoothing & downsampling.) Recommended usage Interface definition Process M0 Function function xASL_wrp_ProcessM0(x) Description Submodule of ExploreASL ASL Module, for M0 image processing. Workflow This submodule performs the image processing and quantification of M0 maps (if they exist), with the following steps: Register M0 to mean control if it exists: Before registration, contrast is equalized between the images & biasfields are removed. Quantify M0 (correction scale slope & incomplete T1 recovery) Masking & smoothing of M0 image, either using: A) traditional technique (very sharp masking & little smoothing) B) new ExploreASL-specific technique: extrapolating outside mask (avoiding artifacts from too much or too little masking) smooth very extensively, to create a biasfield (increases robustness & comparison of M0 between sequences/patients) Any M0 will be processed here. Even if part of the subjects does not have an M0 , since this can be later imputed, or an average population M0 image could be used. Also, without background suppression and without an M0 , the MeanControl image is before saved as M0 , and will be processed here as well. Note that any voxel-size differences between M0 and ASL are allowed here: step 0B below rescales the PD inside an M0 voxel to the same as the ASL resolution (assuming a voxel with half volume contains half the amount of protons). The M0 is further processed in standard space, and reduced to a biasfield. For the quantification in standard space, the PWI and M0 are now by definition in the same space. Also, the standard space M0 biasfield is resampled to the native PWI space (at the end of step 3B) , ensuring that both are also in the same native space. Recommended usage Interface definition Quantify Function function xASL_wrp_Quantify(x, PWI_Path, OutputPath, M0Path, SliceGradientPath) Description Submodule of ExploreASL ASL Module, that performs quantfication. Workflow This submodule converts PWIs to quantified CBF maps (or related derivatives): Load PWI Prepare M0 Hematocrit & blood T1 correction ASL & M0 parameters comparisons Load SliceGradient Initialize & define quantification parameters Define labeling efficiency Perform quantification Save files Perform FEAST quantification (if exist) Recommended usage Interface definition Realign ASL Function function xASL_wrp_RealignASL(x,bSubtraction) Description Submodule of ExploreASL ASL Module, that realigns. Workflow This submodule estimates motion by spm_realign, which uses a rigid-body registration (3 translations, 3 rotations). It runs ENABLE to reject outliers and provides a visualization. ENABLE , QC and visualizations are based on the Net Displacement Vector ( NDV ) (in mm): according to Pythagorean/Euclydian RMS . Link: jiscmail View this link for image of rotation roll, pitch and yaw: grcnasa This submodule performs the following steps: 1. Estimate motion 2. Calculate and plot position and motion parameters 3. Threshold-free spike definition (based on ENABLE , but with t-stats rather than the threshold p<0.05) 4. Remove spike frames from Nifti Recommended usage Interface definition Register ASL Function function xASL_wrp_RegisterASL(x) Description Submodule of ExploreASL ASL Module, that registers ASL to T1w (or potentially other structural images). Workflow This submodule registers ASL images to T1w space, by using a combination of the registration techniques below. Note that in the absence of raw structural files (i.e. T1 .nii[.gz] or T1_ORI .nii[.gz], it will recreate dummy files from standard space to do this registration. M0-T1w rigid-body -> this works well in 2D EPI sequences PWI-pGM rigid-body -> this is robust across sequences with different readouts and consequently different effective spatial resolutions. With low spatial resolution (e.g. GE 3D spiral product sequence), M0-T1w registration may not work, but PWI-pGM will work. PWI-pGM registration fails with large (vascular) artifacts, therefore this is performed only with relatively low spatial CoV . PWI-pGM affine -> If the spatial CoV is sufficiently low, this can improve the registration These images are registered to ASL templates that were inversely transformed from MNI to the T1w space (& resampled to the ASL space) As this would have an ever higher similarity with the M0 & PWI . This submodule performs the following steps: Administration: ASL4D is dealth with, if motion peaks were removed this is called despiked_ASL4D a default \"OtherList\" is specified. This is used every registration instance, except for removing the ref and src NIfTIs used in the registration instance. Also, inside the registration function the unexisting OtherList NIfTIs are skipped Define paths to the ASL templates Previous registration output files are removed Allow registration without structural data native -> MNI transformation flow field y_T1.nii is smoothed to the effective ASL resolution y_ASL.nii Registration contrasts are dealth with: x.bRegistrationContrast - specifies the image contrast used for registration (OPTIONAL, DEFAULT = 2): 0 = Control -> T1w 1 = CBF -> pseudoCBF from template/ pGM + pWM (skip if sCoV >0.667) 2 = automatic (mix of both) 3 = option 2 & force CBF -> pseudoCBF irrespective of sCoV or Tanimoto coefficient Dummy src NIfTIs are created: mean_control.nii to register with T1w mean_PWI_Clipped.nii to register with pseudoCBF Create reference images, downsampled pseudoTissue Registration Center of Mass Registration ASL -> anat (Control -> T1w ) (this step is only applied if it improves the Tanimoto coefficient) Registration CBF->pseudoCBF (this step is only applied if it improves the Tanimoto coefficient). Also, this step is only applied if the spatial CoV < 0.67. Note that this is usually the case for 3D scans because of their lower effective spatial resolution. x.bAffineRegistration - specifies the ASL-T1w rigid-body registration is followed up by an affine registration (OPTIONAL, DEFAULT = 2) 0 = affine registration disabled 1 = affine registration enabled 2 = affine registration automatically chosen based on spatial CoV of PWI Recommended usage Interface definition Resample ASL Function function xASL_wrp_ResampleASL(x) Description Submodule of ExploreASL ASL Module, that reslices native space images to standard space. Workflow This submodule resamples native space NIfTIs to standard space, using the deformation fields computed in the structural module after smoothing these transformation fields to the ASL resolution. The applied interpolation is a combination of all transformations (e.g. motion correction, registration to T1w , and transformation of T1w to standard space. This submodule performs the following steps: Create slice gradient image for quantification reference, in case of 2D ASL Reslice ASL time series to MNI space (currently 1.5 mm^3) Create mean control image, if available: This also applies a bilateral filter, if requested. If x.M0 is set as UseControlAsM0, this mean control NIfTI will be copied to an M0 NIfTI (and processed in the M0 submodule). Perform pair-wise subtraction (to create PWI.nii ), in native space Same in standard space Save PWI NIfTI & time-series-related maps ( SD, SNR ) Recommended usage Interface definition Visual QC ASL Function function xASL_wrp_VisualQC_ASL(x) Description Submodule of ExploreASL ASL Module, that performs several visualizations for QC . Workflow This submodule performs several visualizations for visual & quantitative QC . 1. After initial admin 2. It starts with making ASL NIfTIs ready for visualization & conversion to DICOM (though skipped by default) 3. Then it performs a collection of visualizations 4. Visualizes results of the TopUp geometric distortion correction 5. Visualization of slice gradient 6. Visualization & calculation of temporal QC parameters 7. Compute DICE overlap/intersection of ASL brain in FoV & T1w , to calculate coverage 8. Summarize orientation & check left-right flips 9. Collect several other parameters & store in PDF overview Recommended usage Interface definition","title":"Module ASL"},{"location":"ASL_Module/#submodules-of-the-asl-module","text":"","title":"Submodules of the ASL Module"},{"location":"ASL_Module/#create-analysis-mask","text":"","title":"Create Analysis Mask"},{"location":"ASL_Module/#function","text":"function xASL_wrp_CreateAnalysisMask(x)","title":"Function"},{"location":"ASL_Module/#description","text":"Create analysis mask from a combination of FoV & removal of high and negative intravascular ASL voxels.","title":"Description"},{"location":"ASL_Module/#workflow","text":"Create FoV mask (native & MNI spaces) Detect negative vascular signal (native & MNI spaces, within pGM >0.5) Detect peak vascular signal (native & MNI spaces, within pGM ==80% percentile on ASL image) Brainmasking & FoV -masking (A) native & B) MNI spaces): Add WM vascular parts back to the mask (defined as pWM>0.8) & remove extracranial signal. In the WM , negative or peak signal is more expected from noise rather than from intra-vascular signal, not many big vessels exist in the WM . Save vascular masks Create susceptibility mask (standard space only): Here, we combine manually segmented susceptibility artifact regions in which a population-based susceptibility probability map is created. This map is combined (i.e. taking the product) with the mean control & PWI intensity distribution in these regions. This product is thresholded with the average of the 75th percentile & 15% of the intensity (for a bit more robustness against individual variability in sinus sizes). Create standard space CBF_masked image to visualize masking effect","title":"Workflow"},{"location":"ASL_Module/#recommended-usage","text":"","title":"Recommended usage"},{"location":"ASL_Module/#interface-definition","text":"","title":"Interface definition"},{"location":"ASL_Module/#prepare-pv","text":"","title":"Prepare PV"},{"location":"ASL_Module/#function_1","text":"function x = xASL_wrp_PreparePV(x, bStandardSpace)","title":"Function"},{"location":"ASL_Module/#description_1","text":"Submodule of ExploreASL ASL Module, to prepare PV maps on ASL resolution.","title":"Description"},{"location":"ASL_Module/#workflow_1","text":"This submodule prepares partial volume correction ( PVC ) by creating correct PV maps in ASL resolution, in native space, as well as in standard space if requested (to perform PVC in standard space). If bStandardSpace: 1. Create dummy upsampled ASL scan, for registration 2. Reslice pGM & pWM to hi-res ASL 3. Estimate effective spatial resolution of ASL 4. Smooth pGM & pWM to this spatial resolution 5. Move smoothed tissue posteriors to MNI space Else: Run step 3 only, which will use the effective spatial resolution that is default for the respective sequence: 2D EPI : [1 1 1] * VoxelSize 3D GRASE : [1.1 1.1 1.38] * VoxelSize 3D spiral : [4.3 4.4 10.1] * VoxelSize (assuming GE uses the upsampled 2x2x4 mm ...& run steps 1&2, but in native space these entail presmoothing & downsampling.)","title":"Workflow"},{"location":"ASL_Module/#recommended-usage_1","text":"","title":"Recommended usage"},{"location":"ASL_Module/#interface-definition_1","text":"","title":"Interface definition"},{"location":"ASL_Module/#process-m0","text":"","title":"Process M0"},{"location":"ASL_Module/#function_2","text":"function xASL_wrp_ProcessM0(x)","title":"Function"},{"location":"ASL_Module/#description_2","text":"Submodule of ExploreASL ASL Module, for M0 image processing.","title":"Description"},{"location":"ASL_Module/#workflow_2","text":"This submodule performs the image processing and quantification of M0 maps (if they exist), with the following steps: Register M0 to mean control if it exists: Before registration, contrast is equalized between the images & biasfields are removed. Quantify M0 (correction scale slope & incomplete T1 recovery) Masking & smoothing of M0 image, either using: A) traditional technique (very sharp masking & little smoothing) B) new ExploreASL-specific technique: extrapolating outside mask (avoiding artifacts from too much or too little masking) smooth very extensively, to create a biasfield (increases robustness & comparison of M0 between sequences/patients) Any M0 will be processed here. Even if part of the subjects does not have an M0 , since this can be later imputed, or an average population M0 image could be used. Also, without background suppression and without an M0 , the MeanControl image is before saved as M0 , and will be processed here as well. Note that any voxel-size differences between M0 and ASL are allowed here: step 0B below rescales the PD inside an M0 voxel to the same as the ASL resolution (assuming a voxel with half volume contains half the amount of protons). The M0 is further processed in standard space, and reduced to a biasfield. For the quantification in standard space, the PWI and M0 are now by definition in the same space. Also, the standard space M0 biasfield is resampled to the native PWI space (at the end of step 3B) , ensuring that both are also in the same native space.","title":"Workflow"},{"location":"ASL_Module/#recommended-usage_2","text":"","title":"Recommended usage"},{"location":"ASL_Module/#interface-definition_2","text":"","title":"Interface definition"},{"location":"ASL_Module/#quantify","text":"","title":"Quantify"},{"location":"ASL_Module/#function_3","text":"function xASL_wrp_Quantify(x, PWI_Path, OutputPath, M0Path, SliceGradientPath)","title":"Function"},{"location":"ASL_Module/#description_3","text":"Submodule of ExploreASL ASL Module, that performs quantfication.","title":"Description"},{"location":"ASL_Module/#workflow_3","text":"This submodule converts PWIs to quantified CBF maps (or related derivatives): Load PWI Prepare M0 Hematocrit & blood T1 correction ASL & M0 parameters comparisons Load SliceGradient Initialize & define quantification parameters Define labeling efficiency Perform quantification Save files Perform FEAST quantification (if exist)","title":"Workflow"},{"location":"ASL_Module/#recommended-usage_3","text":"","title":"Recommended usage"},{"location":"ASL_Module/#interface-definition_3","text":"","title":"Interface definition"},{"location":"ASL_Module/#realign-asl","text":"","title":"Realign ASL"},{"location":"ASL_Module/#function_4","text":"function xASL_wrp_RealignASL(x,bSubtraction)","title":"Function"},{"location":"ASL_Module/#description_4","text":"Submodule of ExploreASL ASL Module, that realigns.","title":"Description"},{"location":"ASL_Module/#workflow_4","text":"This submodule estimates motion by spm_realign, which uses a rigid-body registration (3 translations, 3 rotations). It runs ENABLE to reject outliers and provides a visualization. ENABLE , QC and visualizations are based on the Net Displacement Vector ( NDV ) (in mm): according to Pythagorean/Euclydian RMS . Link: jiscmail View this link for image of rotation roll, pitch and yaw: grcnasa This submodule performs the following steps: 1. Estimate motion 2. Calculate and plot position and motion parameters 3. Threshold-free spike definition (based on ENABLE , but with t-stats rather than the threshold p<0.05) 4. Remove spike frames from Nifti","title":"Workflow"},{"location":"ASL_Module/#recommended-usage_4","text":"","title":"Recommended usage"},{"location":"ASL_Module/#interface-definition_4","text":"","title":"Interface definition"},{"location":"ASL_Module/#register-asl","text":"","title":"Register ASL"},{"location":"ASL_Module/#function_5","text":"function xASL_wrp_RegisterASL(x)","title":"Function"},{"location":"ASL_Module/#description_5","text":"Submodule of ExploreASL ASL Module, that registers ASL to T1w (or potentially other structural images).","title":"Description"},{"location":"ASL_Module/#workflow_5","text":"This submodule registers ASL images to T1w space, by using a combination of the registration techniques below. Note that in the absence of raw structural files (i.e. T1 .nii[.gz] or T1_ORI .nii[.gz], it will recreate dummy files from standard space to do this registration. M0-T1w rigid-body -> this works well in 2D EPI sequences PWI-pGM rigid-body -> this is robust across sequences with different readouts and consequently different effective spatial resolutions. With low spatial resolution (e.g. GE 3D spiral product sequence), M0-T1w registration may not work, but PWI-pGM will work. PWI-pGM registration fails with large (vascular) artifacts, therefore this is performed only with relatively low spatial CoV . PWI-pGM affine -> If the spatial CoV is sufficiently low, this can improve the registration These images are registered to ASL templates that were inversely transformed from MNI to the T1w space (& resampled to the ASL space) As this would have an ever higher similarity with the M0 & PWI . This submodule performs the following steps: Administration: ASL4D is dealth with, if motion peaks were removed this is called despiked_ASL4D a default \"OtherList\" is specified. This is used every registration instance, except for removing the ref and src NIfTIs used in the registration instance. Also, inside the registration function the unexisting OtherList NIfTIs are skipped Define paths to the ASL templates Previous registration output files are removed Allow registration without structural data native -> MNI transformation flow field y_T1.nii is smoothed to the effective ASL resolution y_ASL.nii Registration contrasts are dealth with: x.bRegistrationContrast - specifies the image contrast used for registration (OPTIONAL, DEFAULT = 2): 0 = Control -> T1w 1 = CBF -> pseudoCBF from template/ pGM + pWM (skip if sCoV >0.667) 2 = automatic (mix of both) 3 = option 2 & force CBF -> pseudoCBF irrespective of sCoV or Tanimoto coefficient Dummy src NIfTIs are created: mean_control.nii to register with T1w mean_PWI_Clipped.nii to register with pseudoCBF Create reference images, downsampled pseudoTissue Registration Center of Mass Registration ASL -> anat (Control -> T1w ) (this step is only applied if it improves the Tanimoto coefficient) Registration CBF->pseudoCBF (this step is only applied if it improves the Tanimoto coefficient). Also, this step is only applied if the spatial CoV < 0.67. Note that this is usually the case for 3D scans because of their lower effective spatial resolution. x.bAffineRegistration - specifies the ASL-T1w rigid-body registration is followed up by an affine registration (OPTIONAL, DEFAULT = 2) 0 = affine registration disabled 1 = affine registration enabled 2 = affine registration automatically chosen based on spatial CoV of PWI","title":"Workflow"},{"location":"ASL_Module/#recommended-usage_5","text":"","title":"Recommended usage"},{"location":"ASL_Module/#interface-definition_5","text":"","title":"Interface definition"},{"location":"ASL_Module/#resample-asl","text":"","title":"Resample ASL"},{"location":"ASL_Module/#function_6","text":"function xASL_wrp_ResampleASL(x)","title":"Function"},{"location":"ASL_Module/#description_6","text":"Submodule of ExploreASL ASL Module, that reslices native space images to standard space.","title":"Description"},{"location":"ASL_Module/#workflow_6","text":"This submodule resamples native space NIfTIs to standard space, using the deformation fields computed in the structural module after smoothing these transformation fields to the ASL resolution. The applied interpolation is a combination of all transformations (e.g. motion correction, registration to T1w , and transformation of T1w to standard space. This submodule performs the following steps: Create slice gradient image for quantification reference, in case of 2D ASL Reslice ASL time series to MNI space (currently 1.5 mm^3) Create mean control image, if available: This also applies a bilateral filter, if requested. If x.M0 is set as UseControlAsM0, this mean control NIfTI will be copied to an M0 NIfTI (and processed in the M0 submodule). Perform pair-wise subtraction (to create PWI.nii ), in native space Same in standard space Save PWI NIfTI & time-series-related maps ( SD, SNR )","title":"Workflow"},{"location":"ASL_Module/#recommended-usage_6","text":"","title":"Recommended usage"},{"location":"ASL_Module/#interface-definition_6","text":"","title":"Interface definition"},{"location":"ASL_Module/#visual-qc-asl","text":"","title":"Visual QC ASL"},{"location":"ASL_Module/#function_7","text":"function xASL_wrp_VisualQC_ASL(x)","title":"Function"},{"location":"ASL_Module/#description_7","text":"Submodule of ExploreASL ASL Module, that performs several visualizations for QC .","title":"Description"},{"location":"ASL_Module/#workflow_7","text":"This submodule performs several visualizations for visual & quantitative QC . 1. After initial admin 2. It starts with making ASL NIfTIs ready for visualization & conversion to DICOM (though skipped by default) 3. Then it performs a collection of visualizations 4. Visualizes results of the TopUp geometric distortion correction 5. Visualization of slice gradient 6. Visualization & calculation of temporal QC parameters 7. Compute DICE overlap/intersection of ASL brain in FoV & T1w , to calculate coverage 8. Summarize orientation & check left-right flips 9. Collect several other parameters & store in PDF overview","title":"Workflow"},{"location":"ASL_Module/#recommended-usage_7","text":"","title":"Recommended usage"},{"location":"ASL_Module/#interface-definition_7","text":"","title":"Interface definition"},{"location":"About/","text":"About Test","title":"About"},{"location":"About/#about","text":"","title":"About"},{"location":"About/#test","text":"","title":"Test"},{"location":"Functions/","text":"List of ExploreASL Functions xASL_adm_CatchNumbersFromString Function function [OutputNumber] = xASL_adm_CatchNumbersFromString(InputString) Description ... xASL_adm_CheckFileCount Function function [result, files] = xASL_adm_CheckFileCount(path, expr, mincount, failifmissing) Description Checks the given PATH for files corresponding to the SPM_SELECT regular expression EXPR. Returns if the number of files is equal to or higher than MINCOUNT. If FAILIFMISSING is true and not enough files, then throw and error. If everything goes ok and second output argument is specified then return also the list of files. xASL_adm_CheckPermissions Function function [FilesList, FilesExeList, FoldersList] = xASL_adm_CheckPermissions(InputPath, FilesExecutable) Description This function does a recursive search through the root folder & makes a list of the attributes of all files and folders. It tries to reset the attributes to what we desire, which is by default: 664 for files (meaning only reading & writing for users & group, & read-only for others) 775 for folders (meaning reading, writing & opening for current user & current group, & for others only reading & opening) For executable files we also want 775. Note that the permission to 'execute a folder' means opening them xASL_adm_CheckSPM Function function [spm_path, spm_version] = xASL_adm_CheckSPM(modality, proposed_spm_path, check_mode) Description Checks if the spm function exists and if the reported version matches our development version (SPM8 or SPM12). If the spm toolbox is not available yet, it will try the PROPOSED_SPM_PATH (if specified) or the user selected directory and add it to PATH. The function will fail if SPM cannot be found or if detecting an unsupported version. xASL_adm_CleanUpBeforeRerun Function function xASL_adm_CleanUpBeforeRerun(AnalysisDir, iModule, bRemoveWMH, bAllSubjects, SubjectID, SessionID) Description This function (partly) reverts previous ExploreASL runs, deleting derivatives, while keeping raw data intact. if bAllSubjects==true, then all subjects and all module derivatives will be removed. This function performs the following steps: If a Population folder doesn't exist yet but dartel does, rename it Remove whole-study data files in AnalysisDir if bAllSubjects Remove lock files/folders for reprocessing Restore backupped _ORI (original) files Delete native space CAT12 temporary folders (always, independent of iModule) Remove native space files for iModule Remove standard space files for iModule Remove population module files Remove or clean up stored x-struct & QC file -> THIS HAS NO SESSION SUPPORT YET xASL_adm_CompareDataSets Function function [RMS] = xASL_adm_CompareDataSets(RefAnalysisRoot,SourceAnalysisRoot,x,type,mutexState) Description Compares two ExploreASL datasets for reproducibility. xASL_adm_CompareLists.m Function function [NewList] = xASL_adm_CompareLists(list1, list2) Description Compare 2 single dimension lists. xASL_adm_ConvertDate2Nr.m Function function [Nr DayInYear] = xASL_adm_ConvertDate2Nr(TempDate) Description Converts date to number input mmdd -> output mm (with days in fractions/floating point). Inverse from ConvertNrDate. xASL_adm_ConvertNr2Time.m Function function Time = xASL_adm_ConvertNr2Time(Nr) Description Converts number to time input hh (with minutes in fractions/floating point) -> output hhmm. Inverse from xASL_adm_ConvertTime2Nr. xASL_adm_ConvertSubjSess2Subj_Sess.m Function function [iSubj iSess] = xASL_adm_ConvertSubjSess2Subj_Sess(nSessions, iSubjSess) Description Converts combined SubjectSession index to subject & session indices. Useful for data lists in ExploreASL. xASL_adm_ConvertTime2Nr.m Function function Nr = xASL_adm_ConvertTime2Nr(Time) Description Converts time to number input hhmm -> output hh (with minutes in fractions/floating point). Inverse from xASL_adm_ConvertNr2Time. xASL_adm_CopyMoveFileList.m Function function [List] = xASL_adm_CopyMoveFileList(OriDir, DstDir, StrRegExp, bMove, bDir, bRecursive, bOverwrite, bVerbose) Description Moves a file to a file, a file to a directory, or a directory to a directory. It keeps the initial extensions, no unzipping or zipping after the move. But it makes sure that only one of .nii and .nii.gz exists in the destination directory. Useful to split a large database. xASL_adm_CorrectName.m Function function strOut = xASL_adm_CorrectName(strIn, bOption, strExclude) Description Finds and replaces all non-word characters either by empty space or by an underscore. Optionally leaves in few selected special characters. Note that if '_' is excluded from replacement, but option 2 is on, then underscores are replaced anyway. xASL_adm_CreateCSVfile.m Function function xASL_adm_CreateCSVfile(CSVfilename,CSVdata) Description Creates a CSV file that can be opened with excel from your data. xASL_adm_CreateFileReport.m Function function x = xASL_adm_CreateFileReport(x, bHasFLAIR, bHasMoCo, bHasM0, bHasLongitudinal) Description Prints a summary of created files or the individual modules (i.e. Structural, Longiutudinal & ASL modules). Provides a quick check to see what has been skipped, an whether all files are present. This script iterates across Native space 1) subject and 2) session files, resampled 3) subject and 4) session files, 5) Lock files and 6) QC Figure files. For all we perform a A) count of the files present, summarized in fileReportSummary.csv, and we B) list the missing files in \"Missing*.csv\" files PM: simplify/optimize this code, to make filename variable changing, search within subject-directories, etc. Combine the parts searching for missing & summarizing count xASL_adm_DefineASLResolution.m Function function x = xASL_adm_DefineASLResolution(x) Description ... xASL_adm_DeleteFilePair.m Function function filepaths = xASL_adm_DeleteFilePair(path, varargin) Description Delete the file given in PATH, and also deletes files with the same name, but with extension given in EXT1, and potentially also EXT2, EXT3... xASL_adm_Dicom2Parms.m Function function [parms, pathDcmDictOut] = xASL_adm_Dicom2Parms(imPar, inp, parmsfile, dcmExtFilter, bUseDCMTK, pathDcmDictIn) Description The function goes through the INP files, reads the DICOM or PAR/REC files and parses their headers. It extracts the DICOM parameters important for ASL, makes sure they are in the correct format, if missing then replaces with default value, it also checks if the parameters are consistent across DICOM files for a single sequence. xASL_adm_FindByRegExp.m Function function [tree, optionalTokens] = xASL_adm_FindByRegExp(root, dirSpecs, varargin) Description Recursively find files in the root directory according to the dirSpecs. xASL_adm_FindStrIndex.m Function function INDEX = xASL_adm_FindStrIndex(ARRAY, STRING) Description Similar to find, but then for a cell array filled with strings. Only takes 4 dimensions. xASL_adm_GetFsList.m Function function RES = xASL_adm_GetFsList(strDirectory, strRegEx, bGetDirNames, bExcludeHidden, bIgnoreCase, nRequired) Description List files or directories from a given path. And optionally uses regular expressions to filter the result with options to exclude hidden files, ignore case, and set a minimal requirement on the number of results. Sorts the results at the end. xASL_adm_GetNumFromStr.m Function function num = xASL_adm_GetNumFromStr(str) Description Obtains single number from string. CAVE there should only be one number! xASL_adm_GetPhilipsScaling.m Function function scaleFactor = xASL_adm_GetPhilipsScaling(parms,header) Description This script provides the correct scaling factors for a NIfTI file. It checks the header of the NIfTI that normally has the same scaling as RescaleSlope in DICOM, it checks if dcm2nii (by the info in JSON) has already converted the scale slopes to floating point. And if not, the derive the correct scaling factor to be applied. xASL_adm_GetUserName.m Function ... Description ... xASL_adm_Hex2Num.m Function ... Description ... xASL_adm_LesionResliceList.m Function ... Description ... xASL_adm_Load4DMemMapping.m Function ... Description ... xASL_adm_LoadParms.m Function ... Description ... xASL_adm_LoadX.m Function ... Description ... xASL_adm_OtherListSPM.m Function ... Description ... xASL_adm_Par2Parms.m Function ... Description ... xASL_adm_ParReadHeader.m Function ... Description ... xASL_adm_Remove_1_SPM.m Function ... Description ... xASL_adm_ReplaceSymbols.m Function ... Description ... xASL_adm_ResetVisualizationSlices.m Function ... Description ... xASL_adm_SaveJSON.m Function ... Description ... xASL_adm_uiGetInput.m Function ... Description ... xASL_adm_UnzipOrCopy.m Function ... Description ... xASL_adm_Voxel2RealWorldCoordinates.m Function ... Description ... xASL_adm_ZipFileList.m Function ... Description ... xASL_bids_Add2ParticipantsTSV.m Function ... Description ... xASL_bids_Dicom2JSON.m Function ... Description ... xASL_bids_InsertJSONFields.m Function ... Description ... xASL_bids_parms2BIDS.m Function ... Description ... xASL_bids_PARREC2JSON.m Function ... Description ... xASL_fsl_RunFSL.m Function ... Description ... xASL_fsl_SetFSLdir.m Function ... Description ... xASL_fsl_TopUp.m Function ... Description ... xASL_import_json.m Function ... Description ... xASL_imwrite.m Function ... Description ... xASL_im_AddIM2QC.m Function ... Description ... xASL_im_BilateralFilter.m Function ... Description ... xASL_im_CenterOfMass.m Function ... Description ... xASL_im_CleanupWMHnoise.m Function ... Description ... xASL_im_ClipExtremes.m Function ... Description ... xASL_im_colorbar.m Function ... Description ... xASL_im_Column2IM.m Function ... Description ... xASL_im_CompareNIfTIResolutionXYZ.m Function ... Description ... xASL_im_ComputeDice.m Function ... Description ... xASL_im_CreateASLDeformationField.m Function ... Description ... xASL_im_CreatePseudoCBF.m Function ... Description ... xASL_im_CreateSliceGradient.m Function ... Description ... xASL_im_CreateVisualFig.m Function ... Description ... xASL_im_CreateVisualLongReg.m Function ... Description ... xASL_im_CropParmsAcquire.m Function ... Description ... xASL_im_CropParmsApply.m Function ... Description ... xASL_im_DecomposeAffineTransformation.m Function ... Description ... xASL_im_DetermineFlip.m Function ... Description ... xASL_im_DilateErodeFull.m Function ... Description ... xASL_im_DilateErodeSeparable.m Function ... Description ... xASL_im_DilateErodeSphere.m Function ... Description ... xASL_im_dilateROI.m Function ... Description ... xASL_im_DummyOrientationNIfTI.m Function ... Description ... xASL_im_EstimateResolution.m Function ... Description ... xASL_im_Flip.m Function ... Description ... xASL_im_FlipOrientation.m Function ... Description ... xASL_im_FlipOrientation2.m Function ... Description ... xASL_im_IM2Column.m Function ... Description ... xASL_im_joinColormap.m Function ... Description ... xASL_im_JointHist.m Function ... Description ... xASL_im_Lesion2CAT.m Function ... Description ... xASL_im_Lesion2Mask.m Function ... Description ... xASL_im_M0ErodeSmoothExtrapolate.m Function ... Description ... xASL_im_MaskNegativeVascularSignal.m Function ... Description ... xASL_im_MaskPeakVascularSignal.m Function ... Description ... xASL_im_Modulation.m Function ... Description ... xASL_im_NormalizeLabelingTerritories.m Function ... Description ... xASL_im_OverlapT1_ASL.m Function ... Description ... xASL_im_PCA.m Function ... Description ... xASL_im_PreSmooth.m Function ... Description ... xASL_im_ProcessM0Conventional.m Function ... Description ... xASL_im_ProjectLabelsOverData.m Function ... Description ... xASL_im_PVCbspline.m Function ... Description ... xASL_im_PVCkernel.m Function ... Description ... xASL_im_ResampleLinearFair.m Function ... Description ... xASL_im_RescaleLinear.m Function ... Description ... xASL_im_RestoreOrientation.m Function ... Description ... xASL_im_rotate.m Function ... Description ... xASL_im_SkullStrip.m Function ... Description ... xASL_im_Smooth3D.m Function ... Description ... xASL_im_TileImages.m Function ... Description ... xASL_im_TransformData2View.m Function ... Description ... xASL_im_Upsample.m Function ... Description ... xASL_im_VisualizeROIs.m Function ... Description ... xASL_im_VisualQC_TopUp.m Function ... Description ... xASL_im_ZeroEdges.m Function ... Description ... xASL_init_ConvertM2JSON.m Function ... Description ... xASL_init_DefaultEffectiveResolution.m Function ... Description ... xASL_init_DefineStudyData.m Function ... Description ... xASL_init_FileSystem.m Function ... Description ... xASL_init_InitializeMutex.m Function ... Description ... xASL_init_LabelColors.mat Function ... Description ... xASL_init_LoadMetadata.m Function ... Description ... xASL_init_LongitudinalRegistration.m Function ... Description ... xASL_init_VisualizationSettings.m Function ... Description ... xASL_io_CreateNifti.m Function ... Description ... xASL_io_dcm2nii.m Function ... Description ... xASL_io_DcmtkRead.m Function ... Description ... xASL_io_MakeNifti4DICOM.m Function ... Description ... xASL_io_PairwiseSubtraction.m Function ... Description ... xASL_io_ReadTheDicom.m Function ... Description ... xASL_io_SplitASL_M0.m Function ... Description ... xASL_Iteration.m Function ... Description ... xASL_num2str.m Function ... Description ... xASL_qc_AsymmetryIndex.m Function ... Description ... xASL_qc_CAT12_IQR.m Function ... Description ... xASL_qc_CollectParameters.m Function ... Description ... xASL_qc_CollectQC_ASL.m Function ... Description ... xASL_qc_CollectQC_func.m Function ... Description ... xASL_qc_CollectQC_Structural.m Function ... Description ... xASL_qc_CollectSoftwareVersions.m Function ... Description ... xASL_qc_CompareTemplate.m Function ... Description ... xASL_qc_ComputeFoVCoverage.m Function ... Description ... xASL_qc_ComputeNiftiOrientation.m Function ... Description ... xASL_qc_CreatePDF.m Function ... Description ... xASL_qc_FA_Outliers.m Function ... Description ... xASL_qc_ObtainQCCategoriesFromJPG.m Function ... Description ... xASL_qc_PCPStructural.m Function ... Description ... xASL_qc_PrintOrientation.m Function ... Description ... xASL_qc_TanimotoCoeff.m Function ... Description ... xASL_qc_temporalSNR.m Function ... Description ... xASL_qc_WADQCDC.m Function ... Description ... xASL_qc_WADQC_GenerateDescriptor.m Function ... Description ... xASL_quant_AgeSex2Hct.m Function ... Description ... xASL_quant_FEAST.m Function ... Description ... xASL_quant_GetControlLabelOrder.m Function ... Description ... xASL_quant_Hct2BloodT1.m Function ... Description ... xASL_quant_M0.m Function ... Description ... xASL_quant_SinglePLD.m Function ... Description ... xASL_spm_affine.m Function ... Description ... xASL_spm_BiasfieldCorrection.m Function ... Description ... xASL_spm_coreg.m Function ... Description ... xASL_spm_deface.m Function ... Description ... xASL_spm_deformations.m Function ... Description ... xASL_stat_AtlasForStats.m Function ... Description ... xASL_stat_ComputeDifferCoV.m Function ... Description ... xASL_stat_ComputeMean.m Function ... Description ... xASL_stat_ComputeSpatialCoV.m Function ... Description ... xASL_stat_EqualVariancesTest.m Function ... Description ... xASL_stat_fcdf.m Function ... Description ... xASL_stat_GetROIstatistics.m Function ... Description ... xASL_stat_MadNan.m Function ... Description ... xASL_stat_MeanSSIM.m Function ... Description ... xASL_stat_MultipleLinReg.m Function ... Description ... xASL_stat_PrintStats.m Function ... Description ... xASL_stat_PSNR.m Function ... Description ... xASL_stat_QuantileNan.m Function ... Description ... xASL_stat_RobustMean.m Function ... Description ... xASL_stat_ShapiroWilk.m Function ... Description ... xASL_stat_StdNan.m Function ... Description ... xASL_stat_SumNan.m Function ... Description ... xASL_stat_tcdf.m Function ... Description ... xASL_stat_ticdf.m Function ... Description ... xASL_stat_ttest.m Function ... Description ... xASL_stat_ttest2.m Function ... Description ... xASL_stat_VarNan.m Function ... Description ... xASL_str2num.m Function ... Description ...","title":"Functions"},{"location":"Functions/#list-of-exploreasl-functions","text":"","title":"List of ExploreASL Functions"},{"location":"Functions/#xasl_adm_catchnumbersfromstring","text":"","title":"xASL_adm_CatchNumbersFromString"},{"location":"Functions/#function","text":"function [OutputNumber] = xASL_adm_CatchNumbersFromString(InputString)","title":"Function"},{"location":"Functions/#description","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_checkfilecount","text":"","title":"xASL_adm_CheckFileCount"},{"location":"Functions/#function_1","text":"function [result, files] = xASL_adm_CheckFileCount(path, expr, mincount, failifmissing)","title":"Function"},{"location":"Functions/#description_1","text":"Checks the given PATH for files corresponding to the SPM_SELECT regular expression EXPR. Returns if the number of files is equal to or higher than MINCOUNT. If FAILIFMISSING is true and not enough files, then throw and error. If everything goes ok and second output argument is specified then return also the list of files.","title":"Description"},{"location":"Functions/#xasl_adm_checkpermissions","text":"","title":"xASL_adm_CheckPermissions"},{"location":"Functions/#function_2","text":"function [FilesList, FilesExeList, FoldersList] = xASL_adm_CheckPermissions(InputPath, FilesExecutable)","title":"Function"},{"location":"Functions/#description_2","text":"This function does a recursive search through the root folder & makes a list of the attributes of all files and folders. It tries to reset the attributes to what we desire, which is by default: 664 for files (meaning only reading & writing for users & group, & read-only for others) 775 for folders (meaning reading, writing & opening for current user & current group, & for others only reading & opening) For executable files we also want 775. Note that the permission to 'execute a folder' means opening them","title":"Description"},{"location":"Functions/#xasl_adm_checkspm","text":"","title":"xASL_adm_CheckSPM"},{"location":"Functions/#function_3","text":"function [spm_path, spm_version] = xASL_adm_CheckSPM(modality, proposed_spm_path, check_mode)","title":"Function"},{"location":"Functions/#description_3","text":"Checks if the spm function exists and if the reported version matches our development version (SPM8 or SPM12). If the spm toolbox is not available yet, it will try the PROPOSED_SPM_PATH (if specified) or the user selected directory and add it to PATH. The function will fail if SPM cannot be found or if detecting an unsupported version.","title":"Description"},{"location":"Functions/#xasl_adm_cleanupbeforererun","text":"","title":"xASL_adm_CleanUpBeforeRerun"},{"location":"Functions/#function_4","text":"function xASL_adm_CleanUpBeforeRerun(AnalysisDir, iModule, bRemoveWMH, bAllSubjects, SubjectID, SessionID)","title":"Function"},{"location":"Functions/#description_4","text":"This function (partly) reverts previous ExploreASL runs, deleting derivatives, while keeping raw data intact. if bAllSubjects==true, then all subjects and all module derivatives will be removed. This function performs the following steps: If a Population folder doesn't exist yet but dartel does, rename it Remove whole-study data files in AnalysisDir if bAllSubjects Remove lock files/folders for reprocessing Restore backupped _ORI (original) files Delete native space CAT12 temporary folders (always, independent of iModule) Remove native space files for iModule Remove standard space files for iModule Remove population module files Remove or clean up stored x-struct & QC file -> THIS HAS NO SESSION SUPPORT YET","title":"Description"},{"location":"Functions/#xasl_adm_comparedatasets","text":"","title":"xASL_adm_CompareDataSets"},{"location":"Functions/#function_5","text":"function [RMS] = xASL_adm_CompareDataSets(RefAnalysisRoot,SourceAnalysisRoot,x,type,mutexState)","title":"Function"},{"location":"Functions/#description_5","text":"Compares two ExploreASL datasets for reproducibility.","title":"Description"},{"location":"Functions/#xasl_adm_comparelistsm","text":"","title":"xASL_adm_CompareLists.m"},{"location":"Functions/#function_6","text":"function [NewList] = xASL_adm_CompareLists(list1, list2)","title":"Function"},{"location":"Functions/#description_6","text":"Compare 2 single dimension lists.","title":"Description"},{"location":"Functions/#xasl_adm_convertdate2nrm","text":"","title":"xASL_adm_ConvertDate2Nr.m"},{"location":"Functions/#function_7","text":"function [Nr DayInYear] = xASL_adm_ConvertDate2Nr(TempDate)","title":"Function"},{"location":"Functions/#description_7","text":"Converts date to number input mmdd -> output mm (with days in fractions/floating point). Inverse from ConvertNrDate.","title":"Description"},{"location":"Functions/#xasl_adm_convertnr2timem","text":"","title":"xASL_adm_ConvertNr2Time.m"},{"location":"Functions/#function_8","text":"function Time = xASL_adm_ConvertNr2Time(Nr)","title":"Function"},{"location":"Functions/#description_8","text":"Converts number to time input hh (with minutes in fractions/floating point) -> output hhmm. Inverse from xASL_adm_ConvertTime2Nr.","title":"Description"},{"location":"Functions/#xasl_adm_convertsubjsess2subj_sessm","text":"","title":"xASL_adm_ConvertSubjSess2Subj_Sess.m"},{"location":"Functions/#function_9","text":"function [iSubj iSess] = xASL_adm_ConvertSubjSess2Subj_Sess(nSessions, iSubjSess)","title":"Function"},{"location":"Functions/#description_9","text":"Converts combined SubjectSession index to subject & session indices. Useful for data lists in ExploreASL.","title":"Description"},{"location":"Functions/#xasl_adm_converttime2nrm","text":"","title":"xASL_adm_ConvertTime2Nr.m"},{"location":"Functions/#function_10","text":"function Nr = xASL_adm_ConvertTime2Nr(Time)","title":"Function"},{"location":"Functions/#description_10","text":"Converts time to number input hhmm -> output hh (with minutes in fractions/floating point). Inverse from xASL_adm_ConvertNr2Time.","title":"Description"},{"location":"Functions/#xasl_adm_copymovefilelistm","text":"","title":"xASL_adm_CopyMoveFileList.m"},{"location":"Functions/#function_11","text":"function [List] = xASL_adm_CopyMoveFileList(OriDir, DstDir, StrRegExp, bMove, bDir, bRecursive, bOverwrite, bVerbose)","title":"Function"},{"location":"Functions/#description_11","text":"Moves a file to a file, a file to a directory, or a directory to a directory. It keeps the initial extensions, no unzipping or zipping after the move. But it makes sure that only one of .nii and .nii.gz exists in the destination directory. Useful to split a large database.","title":"Description"},{"location":"Functions/#xasl_adm_correctnamem","text":"","title":"xASL_adm_CorrectName.m"},{"location":"Functions/#function_12","text":"function strOut = xASL_adm_CorrectName(strIn, bOption, strExclude)","title":"Function"},{"location":"Functions/#description_12","text":"Finds and replaces all non-word characters either by empty space or by an underscore. Optionally leaves in few selected special characters. Note that if '_' is excluded from replacement, but option 2 is on, then underscores are replaced anyway.","title":"Description"},{"location":"Functions/#xasl_adm_createcsvfilem","text":"","title":"xASL_adm_CreateCSVfile.m"},{"location":"Functions/#function_13","text":"function xASL_adm_CreateCSVfile(CSVfilename,CSVdata)","title":"Function"},{"location":"Functions/#description_13","text":"Creates a CSV file that can be opened with excel from your data.","title":"Description"},{"location":"Functions/#xasl_adm_createfilereportm","text":"","title":"xASL_adm_CreateFileReport.m"},{"location":"Functions/#function_14","text":"function x = xASL_adm_CreateFileReport(x, bHasFLAIR, bHasMoCo, bHasM0, bHasLongitudinal)","title":"Function"},{"location":"Functions/#description_14","text":"Prints a summary of created files or the individual modules (i.e. Structural, Longiutudinal & ASL modules). Provides a quick check to see what has been skipped, an whether all files are present. This script iterates across Native space 1) subject and 2) session files, resampled 3) subject and 4) session files, 5) Lock files and 6) QC Figure files. For all we perform a A) count of the files present, summarized in fileReportSummary.csv, and we B) list the missing files in \"Missing*.csv\" files PM: simplify/optimize this code, to make filename variable changing, search within subject-directories, etc. Combine the parts searching for missing & summarizing count","title":"Description"},{"location":"Functions/#xasl_adm_defineaslresolutionm","text":"","title":"xASL_adm_DefineASLResolution.m"},{"location":"Functions/#function_15","text":"function x = xASL_adm_DefineASLResolution(x)","title":"Function"},{"location":"Functions/#description_15","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_deletefilepairm","text":"","title":"xASL_adm_DeleteFilePair.m"},{"location":"Functions/#function_16","text":"function filepaths = xASL_adm_DeleteFilePair(path, varargin)","title":"Function"},{"location":"Functions/#description_16","text":"Delete the file given in PATH, and also deletes files with the same name, but with extension given in EXT1, and potentially also EXT2, EXT3...","title":"Description"},{"location":"Functions/#xasl_adm_dicom2parmsm","text":"","title":"xASL_adm_Dicom2Parms.m"},{"location":"Functions/#function_17","text":"function [parms, pathDcmDictOut] = xASL_adm_Dicom2Parms(imPar, inp, parmsfile, dcmExtFilter, bUseDCMTK, pathDcmDictIn)","title":"Function"},{"location":"Functions/#description_17","text":"The function goes through the INP files, reads the DICOM or PAR/REC files and parses their headers. It extracts the DICOM parameters important for ASL, makes sure they are in the correct format, if missing then replaces with default value, it also checks if the parameters are consistent across DICOM files for a single sequence.","title":"Description"},{"location":"Functions/#xasl_adm_findbyregexpm","text":"","title":"xASL_adm_FindByRegExp.m"},{"location":"Functions/#function_18","text":"function [tree, optionalTokens] = xASL_adm_FindByRegExp(root, dirSpecs, varargin)","title":"Function"},{"location":"Functions/#description_18","text":"Recursively find files in the root directory according to the dirSpecs.","title":"Description"},{"location":"Functions/#xasl_adm_findstrindexm","text":"","title":"xASL_adm_FindStrIndex.m"},{"location":"Functions/#function_19","text":"function INDEX = xASL_adm_FindStrIndex(ARRAY, STRING)","title":"Function"},{"location":"Functions/#description_19","text":"Similar to find, but then for a cell array filled with strings. Only takes 4 dimensions.","title":"Description"},{"location":"Functions/#xasl_adm_getfslistm","text":"","title":"xASL_adm_GetFsList.m"},{"location":"Functions/#function_20","text":"function RES = xASL_adm_GetFsList(strDirectory, strRegEx, bGetDirNames, bExcludeHidden, bIgnoreCase, nRequired)","title":"Function"},{"location":"Functions/#description_20","text":"List files or directories from a given path. And optionally uses regular expressions to filter the result with options to exclude hidden files, ignore case, and set a minimal requirement on the number of results. Sorts the results at the end.","title":"Description"},{"location":"Functions/#xasl_adm_getnumfromstrm","text":"","title":"xASL_adm_GetNumFromStr.m"},{"location":"Functions/#function_21","text":"function num = xASL_adm_GetNumFromStr(str)","title":"Function"},{"location":"Functions/#description_21","text":"Obtains single number from string. CAVE there should only be one number!","title":"Description"},{"location":"Functions/#xasl_adm_getphilipsscalingm","text":"","title":"xASL_adm_GetPhilipsScaling.m"},{"location":"Functions/#function_22","text":"function scaleFactor = xASL_adm_GetPhilipsScaling(parms,header)","title":"Function"},{"location":"Functions/#description_22","text":"This script provides the correct scaling factors for a NIfTI file. It checks the header of the NIfTI that normally has the same scaling as RescaleSlope in DICOM, it checks if dcm2nii (by the info in JSON) has already converted the scale slopes to floating point. And if not, the derive the correct scaling factor to be applied.","title":"Description"},{"location":"Functions/#xasl_adm_getusernamem","text":"","title":"xASL_adm_GetUserName.m"},{"location":"Functions/#function_23","text":"...","title":"Function"},{"location":"Functions/#description_23","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_hex2numm","text":"","title":"xASL_adm_Hex2Num.m"},{"location":"Functions/#function_24","text":"...","title":"Function"},{"location":"Functions/#description_24","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_lesionreslicelistm","text":"","title":"xASL_adm_LesionResliceList.m"},{"location":"Functions/#function_25","text":"...","title":"Function"},{"location":"Functions/#description_25","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_load4dmemmappingm","text":"","title":"xASL_adm_Load4DMemMapping.m"},{"location":"Functions/#function_26","text":"...","title":"Function"},{"location":"Functions/#description_26","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_loadparmsm","text":"","title":"xASL_adm_LoadParms.m"},{"location":"Functions/#function_27","text":"...","title":"Function"},{"location":"Functions/#description_27","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_loadxm","text":"","title":"xASL_adm_LoadX.m"},{"location":"Functions/#function_28","text":"...","title":"Function"},{"location":"Functions/#description_28","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_otherlistspmm","text":"","title":"xASL_adm_OtherListSPM.m"},{"location":"Functions/#function_29","text":"...","title":"Function"},{"location":"Functions/#description_29","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_par2parmsm","text":"","title":"xASL_adm_Par2Parms.m"},{"location":"Functions/#function_30","text":"...","title":"Function"},{"location":"Functions/#description_30","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_parreadheaderm","text":"","title":"xASL_adm_ParReadHeader.m"},{"location":"Functions/#function_31","text":"...","title":"Function"},{"location":"Functions/#description_31","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_remove_1_spmm","text":"","title":"xASL_adm_Remove_1_SPM.m"},{"location":"Functions/#function_32","text":"...","title":"Function"},{"location":"Functions/#description_32","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_replacesymbolsm","text":"","title":"xASL_adm_ReplaceSymbols.m"},{"location":"Functions/#function_33","text":"...","title":"Function"},{"location":"Functions/#description_33","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_resetvisualizationslicesm","text":"","title":"xASL_adm_ResetVisualizationSlices.m"},{"location":"Functions/#function_34","text":"...","title":"Function"},{"location":"Functions/#description_34","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_savejsonm","text":"","title":"xASL_adm_SaveJSON.m"},{"location":"Functions/#function_35","text":"...","title":"Function"},{"location":"Functions/#description_35","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_uigetinputm","text":"","title":"xASL_adm_uiGetInput.m"},{"location":"Functions/#function_36","text":"...","title":"Function"},{"location":"Functions/#description_36","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_unziporcopym","text":"","title":"xASL_adm_UnzipOrCopy.m"},{"location":"Functions/#function_37","text":"...","title":"Function"},{"location":"Functions/#description_37","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_voxel2realworldcoordinatesm","text":"","title":"xASL_adm_Voxel2RealWorldCoordinates.m"},{"location":"Functions/#function_38","text":"...","title":"Function"},{"location":"Functions/#description_38","text":"...","title":"Description"},{"location":"Functions/#xasl_adm_zipfilelistm","text":"","title":"xASL_adm_ZipFileList.m"},{"location":"Functions/#function_39","text":"...","title":"Function"},{"location":"Functions/#description_39","text":"...","title":"Description"},{"location":"Functions/#xasl_bids_add2participantstsvm","text":"","title":"xASL_bids_Add2ParticipantsTSV.m"},{"location":"Functions/#function_40","text":"...","title":"Function"},{"location":"Functions/#description_40","text":"...","title":"Description"},{"location":"Functions/#xasl_bids_dicom2jsonm","text":"","title":"xASL_bids_Dicom2JSON.m"},{"location":"Functions/#function_41","text":"...","title":"Function"},{"location":"Functions/#description_41","text":"...","title":"Description"},{"location":"Functions/#xasl_bids_insertjsonfieldsm","text":"","title":"xASL_bids_InsertJSONFields.m"},{"location":"Functions/#function_42","text":"...","title":"Function"},{"location":"Functions/#description_42","text":"...","title":"Description"},{"location":"Functions/#xasl_bids_parms2bidsm","text":"","title":"xASL_bids_parms2BIDS.m"},{"location":"Functions/#function_43","text":"...","title":"Function"},{"location":"Functions/#description_43","text":"...","title":"Description"},{"location":"Functions/#xasl_bids_parrec2jsonm","text":"","title":"xASL_bids_PARREC2JSON.m"},{"location":"Functions/#function_44","text":"...","title":"Function"},{"location":"Functions/#description_44","text":"...","title":"Description"},{"location":"Functions/#xasl_fsl_runfslm","text":"","title":"xASL_fsl_RunFSL.m"},{"location":"Functions/#function_45","text":"...","title":"Function"},{"location":"Functions/#description_45","text":"...","title":"Description"},{"location":"Functions/#xasl_fsl_setfsldirm","text":"","title":"xASL_fsl_SetFSLdir.m"},{"location":"Functions/#function_46","text":"...","title":"Function"},{"location":"Functions/#description_46","text":"...","title":"Description"},{"location":"Functions/#xasl_fsl_topupm","text":"","title":"xASL_fsl_TopUp.m"},{"location":"Functions/#function_47","text":"...","title":"Function"},{"location":"Functions/#description_47","text":"...","title":"Description"},{"location":"Functions/#xasl_import_jsonm","text":"","title":"xASL_import_json.m"},{"location":"Functions/#function_48","text":"...","title":"Function"},{"location":"Functions/#description_48","text":"...","title":"Description"},{"location":"Functions/#xasl_imwritem","text":"","title":"xASL_imwrite.m"},{"location":"Functions/#function_49","text":"...","title":"Function"},{"location":"Functions/#description_49","text":"...","title":"Description"},{"location":"Functions/#xasl_im_addim2qcm","text":"","title":"xASL_im_AddIM2QC.m"},{"location":"Functions/#function_50","text":"...","title":"Function"},{"location":"Functions/#description_50","text":"...","title":"Description"},{"location":"Functions/#xasl_im_bilateralfilterm","text":"","title":"xASL_im_BilateralFilter.m"},{"location":"Functions/#function_51","text":"...","title":"Function"},{"location":"Functions/#description_51","text":"...","title":"Description"},{"location":"Functions/#xasl_im_centerofmassm","text":"","title":"xASL_im_CenterOfMass.m"},{"location":"Functions/#function_52","text":"...","title":"Function"},{"location":"Functions/#description_52","text":"...","title":"Description"},{"location":"Functions/#xasl_im_cleanupwmhnoisem","text":"","title":"xASL_im_CleanupWMHnoise.m"},{"location":"Functions/#function_53","text":"...","title":"Function"},{"location":"Functions/#description_53","text":"...","title":"Description"},{"location":"Functions/#xasl_im_clipextremesm","text":"","title":"xASL_im_ClipExtremes.m"},{"location":"Functions/#function_54","text":"...","title":"Function"},{"location":"Functions/#description_54","text":"...","title":"Description"},{"location":"Functions/#xasl_im_colorbarm","text":"","title":"xASL_im_colorbar.m"},{"location":"Functions/#function_55","text":"...","title":"Function"},{"location":"Functions/#description_55","text":"...","title":"Description"},{"location":"Functions/#xasl_im_column2imm","text":"","title":"xASL_im_Column2IM.m"},{"location":"Functions/#function_56","text":"...","title":"Function"},{"location":"Functions/#description_56","text":"...","title":"Description"},{"location":"Functions/#xasl_im_compareniftiresolutionxyzm","text":"","title":"xASL_im_CompareNIfTIResolutionXYZ.m"},{"location":"Functions/#function_57","text":"...","title":"Function"},{"location":"Functions/#description_57","text":"...","title":"Description"},{"location":"Functions/#xasl_im_computedicem","text":"","title":"xASL_im_ComputeDice.m"},{"location":"Functions/#function_58","text":"...","title":"Function"},{"location":"Functions/#description_58","text":"...","title":"Description"},{"location":"Functions/#xasl_im_createasldeformationfieldm","text":"","title":"xASL_im_CreateASLDeformationField.m"},{"location":"Functions/#function_59","text":"...","title":"Function"},{"location":"Functions/#description_59","text":"...","title":"Description"},{"location":"Functions/#xasl_im_createpseudocbfm","text":"","title":"xASL_im_CreatePseudoCBF.m"},{"location":"Functions/#function_60","text":"...","title":"Function"},{"location":"Functions/#description_60","text":"...","title":"Description"},{"location":"Functions/#xasl_im_createslicegradientm","text":"","title":"xASL_im_CreateSliceGradient.m"},{"location":"Functions/#function_61","text":"...","title":"Function"},{"location":"Functions/#description_61","text":"...","title":"Description"},{"location":"Functions/#xasl_im_createvisualfigm","text":"","title":"xASL_im_CreateVisualFig.m"},{"location":"Functions/#function_62","text":"...","title":"Function"},{"location":"Functions/#description_62","text":"...","title":"Description"},{"location":"Functions/#xasl_im_createvisuallongregm","text":"","title":"xASL_im_CreateVisualLongReg.m"},{"location":"Functions/#function_63","text":"...","title":"Function"},{"location":"Functions/#description_63","text":"...","title":"Description"},{"location":"Functions/#xasl_im_cropparmsacquirem","text":"","title":"xASL_im_CropParmsAcquire.m"},{"location":"Functions/#function_64","text":"...","title":"Function"},{"location":"Functions/#description_64","text":"...","title":"Description"},{"location":"Functions/#xasl_im_cropparmsapplym","text":"","title":"xASL_im_CropParmsApply.m"},{"location":"Functions/#function_65","text":"...","title":"Function"},{"location":"Functions/#description_65","text":"...","title":"Description"},{"location":"Functions/#xasl_im_decomposeaffinetransformationm","text":"","title":"xASL_im_DecomposeAffineTransformation.m"},{"location":"Functions/#function_66","text":"...","title":"Function"},{"location":"Functions/#description_66","text":"...","title":"Description"},{"location":"Functions/#xasl_im_determineflipm","text":"","title":"xASL_im_DetermineFlip.m"},{"location":"Functions/#function_67","text":"...","title":"Function"},{"location":"Functions/#description_67","text":"...","title":"Description"},{"location":"Functions/#xasl_im_dilateerodefullm","text":"","title":"xASL_im_DilateErodeFull.m"},{"location":"Functions/#function_68","text":"...","title":"Function"},{"location":"Functions/#description_68","text":"...","title":"Description"},{"location":"Functions/#xasl_im_dilateerodeseparablem","text":"","title":"xASL_im_DilateErodeSeparable.m"},{"location":"Functions/#function_69","text":"...","title":"Function"},{"location":"Functions/#description_69","text":"...","title":"Description"},{"location":"Functions/#xasl_im_dilateerodespherem","text":"","title":"xASL_im_DilateErodeSphere.m"},{"location":"Functions/#function_70","text":"...","title":"Function"},{"location":"Functions/#description_70","text":"...","title":"Description"},{"location":"Functions/#xasl_im_dilateroim","text":"","title":"xASL_im_dilateROI.m"},{"location":"Functions/#function_71","text":"...","title":"Function"},{"location":"Functions/#description_71","text":"...","title":"Description"},{"location":"Functions/#xasl_im_dummyorientationniftim","text":"","title":"xASL_im_DummyOrientationNIfTI.m"},{"location":"Functions/#function_72","text":"...","title":"Function"},{"location":"Functions/#description_72","text":"...","title":"Description"},{"location":"Functions/#xasl_im_estimateresolutionm","text":"","title":"xASL_im_EstimateResolution.m"},{"location":"Functions/#function_73","text":"...","title":"Function"},{"location":"Functions/#description_73","text":"...","title":"Description"},{"location":"Functions/#xasl_im_flipm","text":"","title":"xASL_im_Flip.m"},{"location":"Functions/#function_74","text":"...","title":"Function"},{"location":"Functions/#description_74","text":"...","title":"Description"},{"location":"Functions/#xasl_im_fliporientationm","text":"","title":"xASL_im_FlipOrientation.m"},{"location":"Functions/#function_75","text":"...","title":"Function"},{"location":"Functions/#description_75","text":"...","title":"Description"},{"location":"Functions/#xasl_im_fliporientation2m","text":"","title":"xASL_im_FlipOrientation2.m"},{"location":"Functions/#function_76","text":"...","title":"Function"},{"location":"Functions/#description_76","text":"...","title":"Description"},{"location":"Functions/#xasl_im_im2columnm","text":"","title":"xASL_im_IM2Column.m"},{"location":"Functions/#function_77","text":"...","title":"Function"},{"location":"Functions/#description_77","text":"...","title":"Description"},{"location":"Functions/#xasl_im_joincolormapm","text":"","title":"xASL_im_joinColormap.m"},{"location":"Functions/#function_78","text":"...","title":"Function"},{"location":"Functions/#description_78","text":"...","title":"Description"},{"location":"Functions/#xasl_im_jointhistm","text":"","title":"xASL_im_JointHist.m"},{"location":"Functions/#function_79","text":"...","title":"Function"},{"location":"Functions/#description_79","text":"...","title":"Description"},{"location":"Functions/#xasl_im_lesion2catm","text":"","title":"xASL_im_Lesion2CAT.m"},{"location":"Functions/#function_80","text":"...","title":"Function"},{"location":"Functions/#description_80","text":"...","title":"Description"},{"location":"Functions/#xasl_im_lesion2maskm","text":"","title":"xASL_im_Lesion2Mask.m"},{"location":"Functions/#function_81","text":"...","title":"Function"},{"location":"Functions/#description_81","text":"...","title":"Description"},{"location":"Functions/#xasl_im_m0erodesmoothextrapolatem","text":"","title":"xASL_im_M0ErodeSmoothExtrapolate.m"},{"location":"Functions/#function_82","text":"...","title":"Function"},{"location":"Functions/#description_82","text":"...","title":"Description"},{"location":"Functions/#xasl_im_masknegativevascularsignalm","text":"","title":"xASL_im_MaskNegativeVascularSignal.m"},{"location":"Functions/#function_83","text":"...","title":"Function"},{"location":"Functions/#description_83","text":"...","title":"Description"},{"location":"Functions/#xasl_im_maskpeakvascularsignalm","text":"","title":"xASL_im_MaskPeakVascularSignal.m"},{"location":"Functions/#function_84","text":"...","title":"Function"},{"location":"Functions/#description_84","text":"...","title":"Description"},{"location":"Functions/#xasl_im_modulationm","text":"","title":"xASL_im_Modulation.m"},{"location":"Functions/#function_85","text":"...","title":"Function"},{"location":"Functions/#description_85","text":"...","title":"Description"},{"location":"Functions/#xasl_im_normalizelabelingterritoriesm","text":"","title":"xASL_im_NormalizeLabelingTerritories.m"},{"location":"Functions/#function_86","text":"...","title":"Function"},{"location":"Functions/#description_86","text":"...","title":"Description"},{"location":"Functions/#xasl_im_overlapt1_aslm","text":"","title":"xASL_im_OverlapT1_ASL.m"},{"location":"Functions/#function_87","text":"...","title":"Function"},{"location":"Functions/#description_87","text":"...","title":"Description"},{"location":"Functions/#xasl_im_pcam","text":"","title":"xASL_im_PCA.m"},{"location":"Functions/#function_88","text":"...","title":"Function"},{"location":"Functions/#description_88","text":"...","title":"Description"},{"location":"Functions/#xasl_im_presmoothm","text":"","title":"xASL_im_PreSmooth.m"},{"location":"Functions/#function_89","text":"...","title":"Function"},{"location":"Functions/#description_89","text":"...","title":"Description"},{"location":"Functions/#xasl_im_processm0conventionalm","text":"","title":"xASL_im_ProcessM0Conventional.m"},{"location":"Functions/#function_90","text":"...","title":"Function"},{"location":"Functions/#description_90","text":"...","title":"Description"},{"location":"Functions/#xasl_im_projectlabelsoverdatam","text":"","title":"xASL_im_ProjectLabelsOverData.m"},{"location":"Functions/#function_91","text":"...","title":"Function"},{"location":"Functions/#description_91","text":"...","title":"Description"},{"location":"Functions/#xasl_im_pvcbsplinem","text":"","title":"xASL_im_PVCbspline.m"},{"location":"Functions/#function_92","text":"...","title":"Function"},{"location":"Functions/#description_92","text":"...","title":"Description"},{"location":"Functions/#xasl_im_pvckernelm","text":"","title":"xASL_im_PVCkernel.m"},{"location":"Functions/#function_93","text":"...","title":"Function"},{"location":"Functions/#description_93","text":"...","title":"Description"},{"location":"Functions/#xasl_im_resamplelinearfairm","text":"","title":"xASL_im_ResampleLinearFair.m"},{"location":"Functions/#function_94","text":"...","title":"Function"},{"location":"Functions/#description_94","text":"...","title":"Description"},{"location":"Functions/#xasl_im_rescalelinearm","text":"","title":"xASL_im_RescaleLinear.m"},{"location":"Functions/#function_95","text":"...","title":"Function"},{"location":"Functions/#description_95","text":"...","title":"Description"},{"location":"Functions/#xasl_im_restoreorientationm","text":"","title":"xASL_im_RestoreOrientation.m"},{"location":"Functions/#function_96","text":"...","title":"Function"},{"location":"Functions/#description_96","text":"...","title":"Description"},{"location":"Functions/#xasl_im_rotatem","text":"","title":"xASL_im_rotate.m"},{"location":"Functions/#function_97","text":"...","title":"Function"},{"location":"Functions/#description_97","text":"...","title":"Description"},{"location":"Functions/#xasl_im_skullstripm","text":"","title":"xASL_im_SkullStrip.m"},{"location":"Functions/#function_98","text":"...","title":"Function"},{"location":"Functions/#description_98","text":"...","title":"Description"},{"location":"Functions/#xasl_im_smooth3dm","text":"","title":"xASL_im_Smooth3D.m"},{"location":"Functions/#function_99","text":"...","title":"Function"},{"location":"Functions/#description_99","text":"...","title":"Description"},{"location":"Functions/#xasl_im_tileimagesm","text":"","title":"xASL_im_TileImages.m"},{"location":"Functions/#function_100","text":"...","title":"Function"},{"location":"Functions/#description_100","text":"...","title":"Description"},{"location":"Functions/#xasl_im_transformdata2viewm","text":"","title":"xASL_im_TransformData2View.m"},{"location":"Functions/#function_101","text":"...","title":"Function"},{"location":"Functions/#description_101","text":"...","title":"Description"},{"location":"Functions/#xasl_im_upsamplem","text":"","title":"xASL_im_Upsample.m"},{"location":"Functions/#function_102","text":"...","title":"Function"},{"location":"Functions/#description_102","text":"...","title":"Description"},{"location":"Functions/#xasl_im_visualizeroism","text":"","title":"xASL_im_VisualizeROIs.m"},{"location":"Functions/#function_103","text":"...","title":"Function"},{"location":"Functions/#description_103","text":"...","title":"Description"},{"location":"Functions/#xasl_im_visualqc_topupm","text":"","title":"xASL_im_VisualQC_TopUp.m"},{"location":"Functions/#function_104","text":"...","title":"Function"},{"location":"Functions/#description_104","text":"...","title":"Description"},{"location":"Functions/#xasl_im_zeroedgesm","text":"","title":"xASL_im_ZeroEdges.m"},{"location":"Functions/#function_105","text":"...","title":"Function"},{"location":"Functions/#description_105","text":"...","title":"Description"},{"location":"Functions/#xasl_init_convertm2jsonm","text":"","title":"xASL_init_ConvertM2JSON.m"},{"location":"Functions/#function_106","text":"...","title":"Function"},{"location":"Functions/#description_106","text":"...","title":"Description"},{"location":"Functions/#xasl_init_defaulteffectiveresolutionm","text":"","title":"xASL_init_DefaultEffectiveResolution.m"},{"location":"Functions/#function_107","text":"...","title":"Function"},{"location":"Functions/#description_107","text":"...","title":"Description"},{"location":"Functions/#xasl_init_definestudydatam","text":"","title":"xASL_init_DefineStudyData.m"},{"location":"Functions/#function_108","text":"...","title":"Function"},{"location":"Functions/#description_108","text":"...","title":"Description"},{"location":"Functions/#xasl_init_filesystemm","text":"","title":"xASL_init_FileSystem.m"},{"location":"Functions/#function_109","text":"...","title":"Function"},{"location":"Functions/#description_109","text":"...","title":"Description"},{"location":"Functions/#xasl_init_initializemutexm","text":"","title":"xASL_init_InitializeMutex.m"},{"location":"Functions/#function_110","text":"...","title":"Function"},{"location":"Functions/#description_110","text":"...","title":"Description"},{"location":"Functions/#xasl_init_labelcolorsmat","text":"","title":"xASL_init_LabelColors.mat"},{"location":"Functions/#function_111","text":"...","title":"Function"},{"location":"Functions/#description_111","text":"...","title":"Description"},{"location":"Functions/#xasl_init_loadmetadatam","text":"","title":"xASL_init_LoadMetadata.m"},{"location":"Functions/#function_112","text":"...","title":"Function"},{"location":"Functions/#description_112","text":"...","title":"Description"},{"location":"Functions/#xasl_init_longitudinalregistrationm","text":"","title":"xASL_init_LongitudinalRegistration.m"},{"location":"Functions/#function_113","text":"...","title":"Function"},{"location":"Functions/#description_113","text":"...","title":"Description"},{"location":"Functions/#xasl_init_visualizationsettingsm","text":"","title":"xASL_init_VisualizationSettings.m"},{"location":"Functions/#function_114","text":"...","title":"Function"},{"location":"Functions/#description_114","text":"...","title":"Description"},{"location":"Functions/#xasl_io_createniftim","text":"","title":"xASL_io_CreateNifti.m"},{"location":"Functions/#function_115","text":"...","title":"Function"},{"location":"Functions/#description_115","text":"...","title":"Description"},{"location":"Functions/#xasl_io_dcm2niim","text":"","title":"xASL_io_dcm2nii.m"},{"location":"Functions/#function_116","text":"...","title":"Function"},{"location":"Functions/#description_116","text":"...","title":"Description"},{"location":"Functions/#xasl_io_dcmtkreadm","text":"","title":"xASL_io_DcmtkRead.m"},{"location":"Functions/#function_117","text":"...","title":"Function"},{"location":"Functions/#description_117","text":"...","title":"Description"},{"location":"Functions/#xasl_io_makenifti4dicomm","text":"","title":"xASL_io_MakeNifti4DICOM.m"},{"location":"Functions/#function_118","text":"...","title":"Function"},{"location":"Functions/#description_118","text":"...","title":"Description"},{"location":"Functions/#xasl_io_pairwisesubtractionm","text":"","title":"xASL_io_PairwiseSubtraction.m"},{"location":"Functions/#function_119","text":"...","title":"Function"},{"location":"Functions/#description_119","text":"...","title":"Description"},{"location":"Functions/#xasl_io_readthedicomm","text":"","title":"xASL_io_ReadTheDicom.m"},{"location":"Functions/#function_120","text":"...","title":"Function"},{"location":"Functions/#description_120","text":"...","title":"Description"},{"location":"Functions/#xasl_io_splitasl_m0m","text":"","title":"xASL_io_SplitASL_M0.m"},{"location":"Functions/#function_121","text":"...","title":"Function"},{"location":"Functions/#description_121","text":"...","title":"Description"},{"location":"Functions/#xasl_iterationm","text":"","title":"xASL_Iteration.m"},{"location":"Functions/#function_122","text":"...","title":"Function"},{"location":"Functions/#description_122","text":"...","title":"Description"},{"location":"Functions/#xasl_num2strm","text":"","title":"xASL_num2str.m"},{"location":"Functions/#function_123","text":"...","title":"Function"},{"location":"Functions/#description_123","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_asymmetryindexm","text":"","title":"xASL_qc_AsymmetryIndex.m"},{"location":"Functions/#function_124","text":"...","title":"Function"},{"location":"Functions/#description_124","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_cat12_iqrm","text":"","title":"xASL_qc_CAT12_IQR.m"},{"location":"Functions/#function_125","text":"...","title":"Function"},{"location":"Functions/#description_125","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_collectparametersm","text":"","title":"xASL_qc_CollectParameters.m"},{"location":"Functions/#function_126","text":"...","title":"Function"},{"location":"Functions/#description_126","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_collectqc_aslm","text":"","title":"xASL_qc_CollectQC_ASL.m"},{"location":"Functions/#function_127","text":"...","title":"Function"},{"location":"Functions/#description_127","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_collectqc_funcm","text":"","title":"xASL_qc_CollectQC_func.m"},{"location":"Functions/#function_128","text":"...","title":"Function"},{"location":"Functions/#description_128","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_collectqc_structuralm","text":"","title":"xASL_qc_CollectQC_Structural.m"},{"location":"Functions/#function_129","text":"...","title":"Function"},{"location":"Functions/#description_129","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_collectsoftwareversionsm","text":"","title":"xASL_qc_CollectSoftwareVersions.m"},{"location":"Functions/#function_130","text":"...","title":"Function"},{"location":"Functions/#description_130","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_comparetemplatem","text":"","title":"xASL_qc_CompareTemplate.m"},{"location":"Functions/#function_131","text":"...","title":"Function"},{"location":"Functions/#description_131","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_computefovcoveragem","text":"","title":"xASL_qc_ComputeFoVCoverage.m"},{"location":"Functions/#function_132","text":"...","title":"Function"},{"location":"Functions/#description_132","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_computeniftiorientationm","text":"","title":"xASL_qc_ComputeNiftiOrientation.m"},{"location":"Functions/#function_133","text":"...","title":"Function"},{"location":"Functions/#description_133","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_createpdfm","text":"","title":"xASL_qc_CreatePDF.m"},{"location":"Functions/#function_134","text":"...","title":"Function"},{"location":"Functions/#description_134","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_fa_outliersm","text":"","title":"xASL_qc_FA_Outliers.m"},{"location":"Functions/#function_135","text":"...","title":"Function"},{"location":"Functions/#description_135","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_obtainqccategoriesfromjpgm","text":"","title":"xASL_qc_ObtainQCCategoriesFromJPG.m"},{"location":"Functions/#function_136","text":"...","title":"Function"},{"location":"Functions/#description_136","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_pcpstructuralm","text":"","title":"xASL_qc_PCPStructural.m"},{"location":"Functions/#function_137","text":"...","title":"Function"},{"location":"Functions/#description_137","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_printorientationm","text":"","title":"xASL_qc_PrintOrientation.m"},{"location":"Functions/#function_138","text":"...","title":"Function"},{"location":"Functions/#description_138","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_tanimotocoeffm","text":"","title":"xASL_qc_TanimotoCoeff.m"},{"location":"Functions/#function_139","text":"...","title":"Function"},{"location":"Functions/#description_139","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_temporalsnrm","text":"","title":"xASL_qc_temporalSNR.m"},{"location":"Functions/#function_140","text":"...","title":"Function"},{"location":"Functions/#description_140","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_wadqcdcm","text":"","title":"xASL_qc_WADQCDC.m"},{"location":"Functions/#function_141","text":"...","title":"Function"},{"location":"Functions/#description_141","text":"...","title":"Description"},{"location":"Functions/#xasl_qc_wadqc_generatedescriptorm","text":"","title":"xASL_qc_WADQC_GenerateDescriptor.m"},{"location":"Functions/#function_142","text":"...","title":"Function"},{"location":"Functions/#description_142","text":"...","title":"Description"},{"location":"Functions/#xasl_quant_agesex2hctm","text":"","title":"xASL_quant_AgeSex2Hct.m"},{"location":"Functions/#function_143","text":"...","title":"Function"},{"location":"Functions/#description_143","text":"...","title":"Description"},{"location":"Functions/#xasl_quant_feastm","text":"","title":"xASL_quant_FEAST.m"},{"location":"Functions/#function_144","text":"...","title":"Function"},{"location":"Functions/#description_144","text":"...","title":"Description"},{"location":"Functions/#xasl_quant_getcontrollabelorderm","text":"","title":"xASL_quant_GetControlLabelOrder.m"},{"location":"Functions/#function_145","text":"...","title":"Function"},{"location":"Functions/#description_145","text":"...","title":"Description"},{"location":"Functions/#xasl_quant_hct2bloodt1m","text":"","title":"xASL_quant_Hct2BloodT1.m"},{"location":"Functions/#function_146","text":"...","title":"Function"},{"location":"Functions/#description_146","text":"...","title":"Description"},{"location":"Functions/#xasl_quant_m0m","text":"","title":"xASL_quant_M0.m"},{"location":"Functions/#function_147","text":"...","title":"Function"},{"location":"Functions/#description_147","text":"...","title":"Description"},{"location":"Functions/#xasl_quant_singlepldm","text":"","title":"xASL_quant_SinglePLD.m"},{"location":"Functions/#function_148","text":"...","title":"Function"},{"location":"Functions/#description_148","text":"...","title":"Description"},{"location":"Functions/#xasl_spm_affinem","text":"","title":"xASL_spm_affine.m"},{"location":"Functions/#function_149","text":"...","title":"Function"},{"location":"Functions/#description_149","text":"...","title":"Description"},{"location":"Functions/#xasl_spm_biasfieldcorrectionm","text":"","title":"xASL_spm_BiasfieldCorrection.m"},{"location":"Functions/#function_150","text":"...","title":"Function"},{"location":"Functions/#description_150","text":"...","title":"Description"},{"location":"Functions/#xasl_spm_coregm","text":"","title":"xASL_spm_coreg.m"},{"location":"Functions/#function_151","text":"...","title":"Function"},{"location":"Functions/#description_151","text":"...","title":"Description"},{"location":"Functions/#xasl_spm_defacem","text":"","title":"xASL_spm_deface.m"},{"location":"Functions/#function_152","text":"...","title":"Function"},{"location":"Functions/#description_152","text":"...","title":"Description"},{"location":"Functions/#xasl_spm_deformationsm","text":"","title":"xASL_spm_deformations.m"},{"location":"Functions/#function_153","text":"...","title":"Function"},{"location":"Functions/#description_153","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_atlasforstatsm","text":"","title":"xASL_stat_AtlasForStats.m"},{"location":"Functions/#function_154","text":"...","title":"Function"},{"location":"Functions/#description_154","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_computediffercovm","text":"","title":"xASL_stat_ComputeDifferCoV.m"},{"location":"Functions/#function_155","text":"...","title":"Function"},{"location":"Functions/#description_155","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_computemeanm","text":"","title":"xASL_stat_ComputeMean.m"},{"location":"Functions/#function_156","text":"...","title":"Function"},{"location":"Functions/#description_156","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_computespatialcovm","text":"","title":"xASL_stat_ComputeSpatialCoV.m"},{"location":"Functions/#function_157","text":"...","title":"Function"},{"location":"Functions/#description_157","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_equalvariancestestm","text":"","title":"xASL_stat_EqualVariancesTest.m"},{"location":"Functions/#function_158","text":"...","title":"Function"},{"location":"Functions/#description_158","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_fcdfm","text":"","title":"xASL_stat_fcdf.m"},{"location":"Functions/#function_159","text":"...","title":"Function"},{"location":"Functions/#description_159","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_getroistatisticsm","text":"","title":"xASL_stat_GetROIstatistics.m"},{"location":"Functions/#function_160","text":"...","title":"Function"},{"location":"Functions/#description_160","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_madnanm","text":"","title":"xASL_stat_MadNan.m"},{"location":"Functions/#function_161","text":"...","title":"Function"},{"location":"Functions/#description_161","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_meanssimm","text":"","title":"xASL_stat_MeanSSIM.m"},{"location":"Functions/#function_162","text":"...","title":"Function"},{"location":"Functions/#description_162","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_multiplelinregm","text":"","title":"xASL_stat_MultipleLinReg.m"},{"location":"Functions/#function_163","text":"...","title":"Function"},{"location":"Functions/#description_163","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_printstatsm","text":"","title":"xASL_stat_PrintStats.m"},{"location":"Functions/#function_164","text":"...","title":"Function"},{"location":"Functions/#description_164","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_psnrm","text":"","title":"xASL_stat_PSNR.m"},{"location":"Functions/#function_165","text":"...","title":"Function"},{"location":"Functions/#description_165","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_quantilenanm","text":"","title":"xASL_stat_QuantileNan.m"},{"location":"Functions/#function_166","text":"...","title":"Function"},{"location":"Functions/#description_166","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_robustmeanm","text":"","title":"xASL_stat_RobustMean.m"},{"location":"Functions/#function_167","text":"...","title":"Function"},{"location":"Functions/#description_167","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_shapirowilkm","text":"","title":"xASL_stat_ShapiroWilk.m"},{"location":"Functions/#function_168","text":"...","title":"Function"},{"location":"Functions/#description_168","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_stdnanm","text":"","title":"xASL_stat_StdNan.m"},{"location":"Functions/#function_169","text":"...","title":"Function"},{"location":"Functions/#description_169","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_sumnanm","text":"","title":"xASL_stat_SumNan.m"},{"location":"Functions/#function_170","text":"...","title":"Function"},{"location":"Functions/#description_170","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_tcdfm","text":"","title":"xASL_stat_tcdf.m"},{"location":"Functions/#function_171","text":"...","title":"Function"},{"location":"Functions/#description_171","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_ticdfm","text":"","title":"xASL_stat_ticdf.m"},{"location":"Functions/#function_172","text":"...","title":"Function"},{"location":"Functions/#description_172","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_ttestm","text":"","title":"xASL_stat_ttest.m"},{"location":"Functions/#function_173","text":"...","title":"Function"},{"location":"Functions/#description_173","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_ttest2m","text":"","title":"xASL_stat_ttest2.m"},{"location":"Functions/#function_174","text":"...","title":"Function"},{"location":"Functions/#description_174","text":"...","title":"Description"},{"location":"Functions/#xasl_stat_varnanm","text":"","title":"xASL_stat_VarNan.m"},{"location":"Functions/#function_175","text":"...","title":"Function"},{"location":"Functions/#description_175","text":"...","title":"Description"},{"location":"Functions/#xasl_str2numm","text":"","title":"xASL_str2num.m"},{"location":"Functions/#function_176","text":"...","title":"Function"},{"location":"Functions/#description_176","text":"...","title":"Description"},{"location":"Import_Module/","text":"ExploreASL uses an import workflow based on ...","title":"Module Import"},{"location":"License/","text":"The ExploreASL Software is distributed under the license described below, designed to encourage collabortion while at the same time aiming to reuse commercial profit for academical purpose (e.g. hire an ExploreASL developer). All contents, except for those in the folder //External, are proprietary of ExploreASL. The content in the folder //External is not subject to this license. Provisionary license ExploreASL. This license will be renewed soon after legal checks. ExploreASL, Release 0.999 (c) 2020, Amsterdam University Medical Center (the \"Software\"). The Software remains the property of Amsterdam University Medical Center (AUMC, \"the University\"). The Software is distributed \"AS IS\" under this License solely for non-commercial use in the hope that it will be useful, but in order that the University as a charitable foundation protects its assets for the benefit of its educational and research purposes, the University makes clear that no condition is made or to be implied, nor is any warranty given or to be implied, as to the accuracy of the Software, or that it will be suitable for any particular purpose or for use under any specific conditions. Furthermore, the University disclaims all responsibility for the use which is made of the Software. It further disclaims any liability for the outcomes arising from using the Software. The Licensee agrees to indemnify the University and hold the University harmless from and against any and all claims, damages and liabilities asserted by third parties (including claims for negligence) which arise directly or indirectly from the use of the Software or the sale of any products based on the Software. No part of the Software may be reproduced, modified, transmitted or transferred in any form or by any means, electronic or mechanical, without the express permission of the University. The permission of the University is not required if the said reproduction, modification, transmission or transference is done without financial return, the conditions of this License are imposed upon the receiver of the product, and all original and amended source code is included in any transmitted product. You may be held legally responsible for any copyright infringement that is caused or encouraged by your failure to abide by these terms and conditions. You are not permitted under this License to use this Software commercially. Use for which any financial return is received shall be defined as commercial use, and includes (1) integration of all or part of the source code or the Software into a product for sale or license by or on behalf of Licensee to third parties or (2) use of the Software or any derivative of it for research with the final aim of developing software products for sale or license to a third party or (3) use of the Software or any derivative of it for research with the final aim of developing non-software products for sale or license to a third party, or (4) use of the Software to provide any service to an external organization for which payment is received. If you are interested in collaborating or contributing to this Software, please contact Henk Mutsaerts (h.j.mutsaerts@amsterdamumc.nl). If you are interested in using this Software commercially, please contact Innovation Exchange Amsterdam (\"IXA\"), the technology transfer company of the University, to negotiate a license.","title":"License"},{"location":"Modules/","text":"Modules 1. Module Import Functions function ExploreASL_Import(imPar, bCopySingleDicoms, bUseDCMTK, bCheckPermissions, bRunDCM2NII, bClone2Source, x) Description ... function imPar = ExploreASL_ImportConfig(StudyRoot) Description ... function [x] = ExploreASL_Initialize(DataParPath, ProcessData, iWorker, nWorkers) Description ... 2. Module Structural Function function [result, x] = xASL_module_Structural(x) Description This first ExploreASL module processes the structural images, i.e. high-resolution T1w and FLAIR (if present), on an individual (i.e. subject-to-subject) basis. If a FLAIR is present, this is processed first to obtain a WMH mask to fill the hypointense lesions on the T1w , before segmenting the T1w . For the T1w segmentation this module uses CAT12 by default but if this fails it falls back to SPM after trying to optimize the image contrast. Workflow LinearReg_T1w2MNI : Ensure the alignment of subjects' anterior commissure (AC) with the AC in MNI & apply this to all images LinearReg_FLAIR2T1w : Align the FLAIR (if present) with T1w FLAIR_BiasfieldCorrection : Perform a biasfield correction (if not performed by LST in following steps) LST_Segment_FLAIR_WMH : Segment WMH lesions on FLAIR (if present) LST_T1w_LesionFilling_WMH : Use WMH segmentation to fill lesions on T1w Segment_T1w : Tissue segmentation on T1w CleanUpWMH_SEGM : Extra WMH cleanup of some over- and under-segmentation Resample2StandardSpace : Clone all images to standard space GetVolumetrics : Obtain whole-brain volumes of GM, WM, CSF, WMH VisualQC : Obtain QC parameters & save QC Figures DoWADQCDC : QC for WAD-QC DICOM server (optional) Recommended usage % Initialize dataset DataParPath = \"ExamplePath\"; ProcessData = true; iWorker = 1; nWorkers = 1; x = ExploreASL_Initialize(DataParPath, ProcessData, iWorker, nWorkers); % Run the structural module [~, x] = xASL_Iteration(x,'xASL_module_Structural'); Interface definition Input: x structure Required input fields of the x structure: ... Output Added output fields of the x structure: ... Generated files: ... 3. Module ASL Function function [result, x] = xASL_module_ASL(x) Description This ExploreASL module processes the ASL images, i.e. ASL4D, M0, etc (if present), on an individual (i.e. session-to-session, where session indicates BIDS \"run\") basis. Both 2D and 3D options are automatially chosen, as well as processing of time-series (if available), such as motion correction and outlier exclusion. Workflow TopUpASL : FSL TopUp geometric distortion correction (if M0 images with reversed phase-encoding are present) RealignASL : If time-series are present, motion correction and outlier exclusion (ENABLE) RegisterASL : Registration of ASL to T1w anatomical images (if lacking, to MNI images) ResliceASL : Resample ASL images to standard space PreparePV : Create partial volume images in ASL space with ASL resolution ProcessM0 : M0 image processing Quantification : CBF quantification CreateAnalysisMask : Create mask using FoV, vascular outliers & susceptibility atlas VisualQC_ASL : Generate QC parameters & images WADQC : QC for WAD-QC DICOM server (OPTIONAL) Recommended usage [~, x] = xASL_Iteration(x,'xASL_module_ASL'); Interface definition Input: x structure Required input fields of the x structure: ... Output Added output fields of the x structure: ... Generated files: ... 4. Module Population Function function [result, x] = xASL_module_Population(x) Description This ExploreASL module processes all available images on the group level. It assumes that all images were adequately processed in the previous modules. Workflow CreatePopulationTemplates : Create population average images, to compare scanners, cohorts etc without physiological variance CreateAnalysisMask : Generate a group-level mask by combining individuals masks, for ROI-based analysis & VBA CreateBiasfield : When there are multiple scanners, create scanner-specific biasfields (uses Site.mat for this) GetDICOMStatistics : Create TSV file with overview of DICOM parameters GetVolumeStatistics : Create TSV file with overview of volumetric parameters GetMotionStatistics : Create TSV file with overview of motion parameters GetROIstatistics : Create TSV file with overview of regional values (e.g. qCBF, mean control, pGM etc) SortBySpatialCoV : Sort ASL_Check QC images by their spatial CoV in quality bins DeleteAndZip : Delete temporary files and gzip all NIfTIs Recommended usage [~, x] = xASL_Iteration(x,'xASL_module_Population'); Interface definition Input: x structure Required input fields of the x structure: ... Output Added output fields of the x structure: ... Generated files: ...","title":"Modules"},{"location":"Modules/#modules","text":"","title":"Modules"},{"location":"Modules/#1-module-import","text":"","title":"1. Module Import"},{"location":"Modules/#functions","text":"function ExploreASL_Import(imPar, bCopySingleDicoms, bUseDCMTK, bCheckPermissions, bRunDCM2NII, bClone2Source, x)","title":"Functions"},{"location":"Modules/#description","text":"... function imPar = ExploreASL_ImportConfig(StudyRoot)","title":"Description"},{"location":"Modules/#description_1","text":"... function [x] = ExploreASL_Initialize(DataParPath, ProcessData, iWorker, nWorkers)","title":"Description"},{"location":"Modules/#description_2","text":"...","title":"Description"},{"location":"Modules/#2-module-structural","text":"","title":"2. Module Structural"},{"location":"Modules/#function","text":"function [result, x] = xASL_module_Structural(x)","title":"Function"},{"location":"Modules/#description_3","text":"This first ExploreASL module processes the structural images, i.e. high-resolution T1w and FLAIR (if present), on an individual (i.e. subject-to-subject) basis. If a FLAIR is present, this is processed first to obtain a WMH mask to fill the hypointense lesions on the T1w , before segmenting the T1w . For the T1w segmentation this module uses CAT12 by default but if this fails it falls back to SPM after trying to optimize the image contrast.","title":"Description"},{"location":"Modules/#workflow","text":"LinearReg_T1w2MNI : Ensure the alignment of subjects' anterior commissure (AC) with the AC in MNI & apply this to all images LinearReg_FLAIR2T1w : Align the FLAIR (if present) with T1w FLAIR_BiasfieldCorrection : Perform a biasfield correction (if not performed by LST in following steps) LST_Segment_FLAIR_WMH : Segment WMH lesions on FLAIR (if present) LST_T1w_LesionFilling_WMH : Use WMH segmentation to fill lesions on T1w Segment_T1w : Tissue segmentation on T1w CleanUpWMH_SEGM : Extra WMH cleanup of some over- and under-segmentation Resample2StandardSpace : Clone all images to standard space GetVolumetrics : Obtain whole-brain volumes of GM, WM, CSF, WMH VisualQC : Obtain QC parameters & save QC Figures DoWADQCDC : QC for WAD-QC DICOM server (optional)","title":"Workflow"},{"location":"Modules/#recommended-usage","text":"% Initialize dataset DataParPath = \"ExamplePath\"; ProcessData = true; iWorker = 1; nWorkers = 1; x = ExploreASL_Initialize(DataParPath, ProcessData, iWorker, nWorkers); % Run the structural module [~, x] = xASL_Iteration(x,'xASL_module_Structural');","title":"Recommended usage"},{"location":"Modules/#interface-definition","text":"","title":"Interface definition"},{"location":"Modules/#input-x-structure","text":"Required input fields of the x structure: ...","title":"Input: x structure"},{"location":"Modules/#output","text":"Added output fields of the x structure: ... Generated files: ...","title":"Output"},{"location":"Modules/#3-module-asl","text":"","title":"3. Module ASL"},{"location":"Modules/#function_1","text":"function [result, x] = xASL_module_ASL(x)","title":"Function"},{"location":"Modules/#description_4","text":"This ExploreASL module processes the ASL images, i.e. ASL4D, M0, etc (if present), on an individual (i.e. session-to-session, where session indicates BIDS \"run\") basis. Both 2D and 3D options are automatially chosen, as well as processing of time-series (if available), such as motion correction and outlier exclusion.","title":"Description"},{"location":"Modules/#workflow_1","text":"TopUpASL : FSL TopUp geometric distortion correction (if M0 images with reversed phase-encoding are present) RealignASL : If time-series are present, motion correction and outlier exclusion (ENABLE) RegisterASL : Registration of ASL to T1w anatomical images (if lacking, to MNI images) ResliceASL : Resample ASL images to standard space PreparePV : Create partial volume images in ASL space with ASL resolution ProcessM0 : M0 image processing Quantification : CBF quantification CreateAnalysisMask : Create mask using FoV, vascular outliers & susceptibility atlas VisualQC_ASL : Generate QC parameters & images WADQC : QC for WAD-QC DICOM server (OPTIONAL)","title":"Workflow"},{"location":"Modules/#recommended-usage_1","text":"[~, x] = xASL_Iteration(x,'xASL_module_ASL');","title":"Recommended usage"},{"location":"Modules/#interface-definition_1","text":"","title":"Interface definition"},{"location":"Modules/#input-x-structure_1","text":"Required input fields of the x structure: ...","title":"Input: x structure"},{"location":"Modules/#output_1","text":"Added output fields of the x structure: ... Generated files: ...","title":"Output"},{"location":"Modules/#4-module-population","text":"","title":"4. Module Population"},{"location":"Modules/#function_2","text":"function [result, x] = xASL_module_Population(x)","title":"Function"},{"location":"Modules/#description_5","text":"This ExploreASL module processes all available images on the group level. It assumes that all images were adequately processed in the previous modules.","title":"Description"},{"location":"Modules/#workflow_2","text":"CreatePopulationTemplates : Create population average images, to compare scanners, cohorts etc without physiological variance CreateAnalysisMask : Generate a group-level mask by combining individuals masks, for ROI-based analysis & VBA CreateBiasfield : When there are multiple scanners, create scanner-specific biasfields (uses Site.mat for this) GetDICOMStatistics : Create TSV file with overview of DICOM parameters GetVolumeStatistics : Create TSV file with overview of volumetric parameters GetMotionStatistics : Create TSV file with overview of motion parameters GetROIstatistics : Create TSV file with overview of regional values (e.g. qCBF, mean control, pGM etc) SortBySpatialCoV : Sort ASL_Check QC images by their spatial CoV in quality bins DeleteAndZip : Delete temporary files and gzip all NIfTIs","title":"Workflow"},{"location":"Modules/#recommended-usage_2","text":"[~, x] = xASL_Iteration(x,'xASL_module_Population');","title":"Recommended usage"},{"location":"Modules/#interface-definition_2","text":"","title":"Interface definition"},{"location":"Modules/#input-x-structure_2","text":"Required input fields of the x structure: ...","title":"Input: x structure"},{"location":"Modules/#output_2","text":"Added output fields of the x structure: ... Generated files: ...","title":"Output"},{"location":"Population_Module/","text":"Submodules of the Population Module Delete Many Temp Files Function function xASL_adm_DeleteManyTempFiles(x) Description This function removes as many files as possible. Workflow Recommended usage Interface definition Gzip All Files Function function xASL_adm_GzipAllFiles(ROOT, bFolder, bUseLinux) Description This function zips all .nii files recursively into nii.gz. Note that the linux option cannot deal with spaces in filenames or directories. Workflow Recommended usage Interface definition Create Analysis Mask Function function [x] = xASL_im_CreateAnalysisMask(x, Threshold) Description Creates population analysis mask. Workflow This function takes the mean population-based probability maps of masks, thresholds and combines them: 1. Creation GM, WM & WholeBrain masks by p>0.5 2. Create, combine & save vascular, susceptibity & FoV masks: * MaskVascular * MaskSusceptibility = MaskSusceptibility & MaskFoV 3. Create & save VBA mask * MaskAnalysis = MaskVascular & MaskSusceptibility * x.S.VBAmask = MaskAnalysis & GMmask 4. Visualization: Creates a figure with columns being following maps/masks overlaid over mean population T1w: * FoV probability 0-50% missing voxels * Vascular 0-7.5% missing voxels * Susceptibility 0-50% missing voxels * Analysis mask Recommended usage Interface definition Sort By Spatial CoV Function function xASL_qc_SortBySpatialCoV(x, Threshold1, Threshold2) Description Compute statistics for each ROI. Workflow This function organizes the ASL QC images in //analysis/Population/ASLCheck into CBF, vascular and artifactual contrast per the spatial CoV thresholds defined above, in folders: //analysis/Population/ASLCheck/1_CBFContrast //analysis/Population/ASLCheck/2_VascularContrast //analysis/Population/ASLCheck/3_ArtifactualContrast Invalid spatial CoV numbers (e.g. NaN) will go to: //analysis/Population/ASLCheck/4_Unknown_sCoV Note: these outputs need to be visually checked; but pre-sorting them by spatial CoV puts them already in categories that are quick to skim through and manually correct by moving the images The idea is then that only category 1 images are used for perfusion (CBF) analyses, both categories 1 & 2 for the vascular (sCoV) analyses, and the category 3 images excluded from analysis. PM : this code does not include multiple sessions per subject yet! NB : this code uses the //analysis/Population/Stats/CoV_qCBF TotalGM .csv file, make sure that this file isn't edited! Recommended usage Interface definition Compute Ws CV Function function x = xASL_stat_ComputeWsCV(x) Description Calculates the within and between-subject coefficient of variance (wsCV and bsCV respectively), to estimate the power to detect effects. This requires 4D images that have been split. Workflow Recommended usage Interface definition Get Acquisition Time Function function x = xASL_stat_GetAcquisitionTime(x) Description Summarize the acquisition time of scans. Workflow This functions collects the DICOM field AcquisitionTime from each json sidecar (& parms.mat for backward compatibility) and saves them in the participants.tsv. Additionally, it creates a AcquisitionTime histogram of the full study, which can be useful to check time of scanning -> can influence physiological CBF variability. Collect times Save times Create time histogram Recommended usage Interface definition Get DICOM Statistics Function function xASL_stat_GetDICOMStatistics(x, ScanType, HasSessions, bOverwrite) Description Collect DICOM metadata in CSV file to check. Workflow This functions prints DICOM metadata (e.g. parameters used for quantification) and collects them in a single tsv (per BIDS). Summarizes this for the total population. Can be useful to detect software upgrades, where only slight parameter changes can hint on quantification changes. This function carries out the following steps: Load & save individual parameter files Print summary Write TSV file Recommended usage Interface definition Get Motion Statistics Function function xASL_stat_GetMotionStatistics(x) Description Summarize motion values. Workflow This functions collects motion stats, with the following steps: Collect motion data If no data, skip this function Print motion vs exclusion overview Add motion data to participants.tsv Recommended usage Interface definition Get Volume Statistics Function function xASL_stat_GetVolumeStatistics(x) Description Summarize volume values. Workflow This functions collects motion stats, with the following steps: Collect structural volume data Collect WMH data Add stats in participants.tsv Recommended usage Interface definition Create Biasfield Function function xASL_wrp_CreateBiasfield(x) Description Create sequence-specific intensity biasfields. Workflow This function creates a smooth biasfield as intensity map to normalize intensities between different sequences/scanner/sites within a single study. This is a simple pragmatic approach and is not validated, but is the best we can do. First acquires average additive & multiplicative factors for total GM, then does a smooth voxel-wise rescaling. This doesn't make an assumption whether site or sequence differences are additive or multiplicative, but rather fits them both. Global scaling it performed to GM CBF == 60 mL/100g/min NB : make sure that sequence resolution differences have been taken in account before creating these biasfields. PM : add normalization of between-subjects SD as well. PM : are there other things we can normalize? Recommended usage Interface definition Create Population Templates Function function xASL_wrp_CreatePopulationTemplates(x, SaveUnmasked, bCompute4Sets, SpecificScantype, bSkipMissingScans, bRemoveOutliers, FunctionsAre) Description ExploreASL Population module wrapper, creates population parametric images for each ScanType. Workflow This function creates simple parametric images, a.k.a. templates, for different image/scan types, on population level, as well as for different sets (e.g. sites/scanners/cohorts, etc) if specified. By default these images are masked, and transformed into a single column, for quick computations with low memory usage. The default parametric images that are created are the mean, between-subject SD, and the maximal intensity projection (MIP). The latter can e.g. identify intra-vascular signal that is similar between different subjects. Other parametric maps can be decommented (now commented out for speed). Recommended usage Interface definition Get ROI statistics Function function xASL_wrp_GetROIstatistics(x) Description Compute statistics for each ROI. Workflow This wrapper organizes the computation of statistics for different ROIs in a [1.5 1.5 1.5] mm MNI space: Load the atlas: xASL_stat_AtlasForStats Organize TSV output name: using x.S.output_ID Obtain the ROI statistics: xASL_stat_GetROIstatistics Print statistics in TSV files: xASL_stat_PrintStats Recommended usage Interface definition Load 4D Mem Mapping Lesions ROIs Function function [x] = xASL_wrp_Load4DMemMapping_LesionsROIs(x) Description Part of ExploreASL analysis module. Loads data & maps it to memory mapping file on disc, if not done before. Workflow Recommended usage Interface definition","title":"Module Population"},{"location":"Population_Module/#submodules-of-the-population-module","text":"","title":"Submodules of the Population Module"},{"location":"Population_Module/#delete-many-temp-files","text":"","title":"Delete Many Temp Files"},{"location":"Population_Module/#function","text":"function xASL_adm_DeleteManyTempFiles(x)","title":"Function"},{"location":"Population_Module/#description","text":"This function removes as many files as possible.","title":"Description"},{"location":"Population_Module/#workflow","text":"","title":"Workflow"},{"location":"Population_Module/#recommended-usage","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition","text":"","title":"Interface definition"},{"location":"Population_Module/#gzip-all-files","text":"","title":"Gzip All Files"},{"location":"Population_Module/#function_1","text":"function xASL_adm_GzipAllFiles(ROOT, bFolder, bUseLinux)","title":"Function"},{"location":"Population_Module/#description_1","text":"This function zips all .nii files recursively into nii.gz. Note that the linux option cannot deal with spaces in filenames or directories.","title":"Description"},{"location":"Population_Module/#workflow_1","text":"","title":"Workflow"},{"location":"Population_Module/#recommended-usage_1","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_1","text":"","title":"Interface definition"},{"location":"Population_Module/#create-analysis-mask","text":"","title":"Create Analysis Mask"},{"location":"Population_Module/#function_2","text":"function [x] = xASL_im_CreateAnalysisMask(x, Threshold)","title":"Function"},{"location":"Population_Module/#description_2","text":"Creates population analysis mask.","title":"Description"},{"location":"Population_Module/#workflow_2","text":"This function takes the mean population-based probability maps of masks, thresholds and combines them: 1. Creation GM, WM & WholeBrain masks by p>0.5 2. Create, combine & save vascular, susceptibity & FoV masks: * MaskVascular * MaskSusceptibility = MaskSusceptibility & MaskFoV 3. Create & save VBA mask * MaskAnalysis = MaskVascular & MaskSusceptibility * x.S.VBAmask = MaskAnalysis & GMmask 4. Visualization: Creates a figure with columns being following maps/masks overlaid over mean population T1w: * FoV probability 0-50% missing voxels * Vascular 0-7.5% missing voxels * Susceptibility 0-50% missing voxels * Analysis mask","title":"Workflow"},{"location":"Population_Module/#recommended-usage_2","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_2","text":"","title":"Interface definition"},{"location":"Population_Module/#sort-by-spatial-cov","text":"","title":"Sort By Spatial CoV"},{"location":"Population_Module/#function_3","text":"function xASL_qc_SortBySpatialCoV(x, Threshold1, Threshold2)","title":"Function"},{"location":"Population_Module/#description_3","text":"Compute statistics for each ROI.","title":"Description"},{"location":"Population_Module/#workflow_3","text":"This function organizes the ASL QC images in //analysis/Population/ASLCheck into CBF, vascular and artifactual contrast per the spatial CoV thresholds defined above, in folders: //analysis/Population/ASLCheck/1_CBFContrast //analysis/Population/ASLCheck/2_VascularContrast //analysis/Population/ASLCheck/3_ArtifactualContrast Invalid spatial CoV numbers (e.g. NaN) will go to: //analysis/Population/ASLCheck/4_Unknown_sCoV Note: these outputs need to be visually checked; but pre-sorting them by spatial CoV puts them already in categories that are quick to skim through and manually correct by moving the images The idea is then that only category 1 images are used for perfusion (CBF) analyses, both categories 1 & 2 for the vascular (sCoV) analyses, and the category 3 images excluded from analysis. PM : this code does not include multiple sessions per subject yet! NB : this code uses the //analysis/Population/Stats/CoV_qCBF TotalGM .csv file, make sure that this file isn't edited!","title":"Workflow"},{"location":"Population_Module/#recommended-usage_3","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_3","text":"","title":"Interface definition"},{"location":"Population_Module/#compute-ws-cv","text":"","title":"Compute Ws CV"},{"location":"Population_Module/#function_4","text":"function x = xASL_stat_ComputeWsCV(x)","title":"Function"},{"location":"Population_Module/#description_4","text":"Calculates the within and between-subject coefficient of variance (wsCV and bsCV respectively), to estimate the power to detect effects. This requires 4D images that have been split.","title":"Description"},{"location":"Population_Module/#workflow_4","text":"","title":"Workflow"},{"location":"Population_Module/#recommended-usage_4","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_4","text":"","title":"Interface definition"},{"location":"Population_Module/#get-acquisition-time","text":"","title":"Get Acquisition Time"},{"location":"Population_Module/#function_5","text":"function x = xASL_stat_GetAcquisitionTime(x)","title":"Function"},{"location":"Population_Module/#description_5","text":"Summarize the acquisition time of scans.","title":"Description"},{"location":"Population_Module/#workflow_5","text":"This functions collects the DICOM field AcquisitionTime from each json sidecar (& parms.mat for backward compatibility) and saves them in the participants.tsv. Additionally, it creates a AcquisitionTime histogram of the full study, which can be useful to check time of scanning -> can influence physiological CBF variability. Collect times Save times Create time histogram","title":"Workflow"},{"location":"Population_Module/#recommended-usage_5","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_5","text":"","title":"Interface definition"},{"location":"Population_Module/#get-dicom-statistics","text":"","title":"Get DICOM Statistics"},{"location":"Population_Module/#function_6","text":"function xASL_stat_GetDICOMStatistics(x, ScanType, HasSessions, bOverwrite)","title":"Function"},{"location":"Population_Module/#description_6","text":"Collect DICOM metadata in CSV file to check.","title":"Description"},{"location":"Population_Module/#workflow_6","text":"This functions prints DICOM metadata (e.g. parameters used for quantification) and collects them in a single tsv (per BIDS). Summarizes this for the total population. Can be useful to detect software upgrades, where only slight parameter changes can hint on quantification changes. This function carries out the following steps: Load & save individual parameter files Print summary Write TSV file","title":"Workflow"},{"location":"Population_Module/#recommended-usage_6","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_6","text":"","title":"Interface definition"},{"location":"Population_Module/#get-motion-statistics","text":"","title":"Get Motion Statistics"},{"location":"Population_Module/#function_7","text":"function xASL_stat_GetMotionStatistics(x)","title":"Function"},{"location":"Population_Module/#description_7","text":"Summarize motion values.","title":"Description"},{"location":"Population_Module/#workflow_7","text":"This functions collects motion stats, with the following steps: Collect motion data If no data, skip this function Print motion vs exclusion overview Add motion data to participants.tsv","title":"Workflow"},{"location":"Population_Module/#recommended-usage_7","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_7","text":"","title":"Interface definition"},{"location":"Population_Module/#get-volume-statistics","text":"","title":"Get Volume Statistics"},{"location":"Population_Module/#function_8","text":"function xASL_stat_GetVolumeStatistics(x)","title":"Function"},{"location":"Population_Module/#description_8","text":"Summarize volume values.","title":"Description"},{"location":"Population_Module/#workflow_8","text":"This functions collects motion stats, with the following steps: Collect structural volume data Collect WMH data Add stats in participants.tsv","title":"Workflow"},{"location":"Population_Module/#recommended-usage_8","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_8","text":"","title":"Interface definition"},{"location":"Population_Module/#create-biasfield","text":"","title":"Create Biasfield"},{"location":"Population_Module/#function_9","text":"function xASL_wrp_CreateBiasfield(x)","title":"Function"},{"location":"Population_Module/#description_9","text":"Create sequence-specific intensity biasfields.","title":"Description"},{"location":"Population_Module/#workflow_9","text":"This function creates a smooth biasfield as intensity map to normalize intensities between different sequences/scanner/sites within a single study. This is a simple pragmatic approach and is not validated, but is the best we can do. First acquires average additive & multiplicative factors for total GM, then does a smooth voxel-wise rescaling. This doesn't make an assumption whether site or sequence differences are additive or multiplicative, but rather fits them both. Global scaling it performed to GM CBF == 60 mL/100g/min NB : make sure that sequence resolution differences have been taken in account before creating these biasfields. PM : add normalization of between-subjects SD as well. PM : are there other things we can normalize?","title":"Workflow"},{"location":"Population_Module/#recommended-usage_9","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_9","text":"","title":"Interface definition"},{"location":"Population_Module/#create-population-templates","text":"","title":"Create Population Templates"},{"location":"Population_Module/#function_10","text":"function xASL_wrp_CreatePopulationTemplates(x, SaveUnmasked, bCompute4Sets, SpecificScantype, bSkipMissingScans, bRemoveOutliers, FunctionsAre)","title":"Function"},{"location":"Population_Module/#description_10","text":"ExploreASL Population module wrapper, creates population parametric images for each ScanType.","title":"Description"},{"location":"Population_Module/#workflow_10","text":"This function creates simple parametric images, a.k.a. templates, for different image/scan types, on population level, as well as for different sets (e.g. sites/scanners/cohorts, etc) if specified. By default these images are masked, and transformed into a single column, for quick computations with low memory usage. The default parametric images that are created are the mean, between-subject SD, and the maximal intensity projection (MIP). The latter can e.g. identify intra-vascular signal that is similar between different subjects. Other parametric maps can be decommented (now commented out for speed).","title":"Workflow"},{"location":"Population_Module/#recommended-usage_10","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_10","text":"","title":"Interface definition"},{"location":"Population_Module/#get-roi-statistics","text":"","title":"Get ROI statistics"},{"location":"Population_Module/#function_11","text":"function xASL_wrp_GetROIstatistics(x)","title":"Function"},{"location":"Population_Module/#description_11","text":"Compute statistics for each ROI.","title":"Description"},{"location":"Population_Module/#workflow_11","text":"This wrapper organizes the computation of statistics for different ROIs in a [1.5 1.5 1.5] mm MNI space: Load the atlas: xASL_stat_AtlasForStats Organize TSV output name: using x.S.output_ID Obtain the ROI statistics: xASL_stat_GetROIstatistics Print statistics in TSV files: xASL_stat_PrintStats","title":"Workflow"},{"location":"Population_Module/#recommended-usage_11","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_11","text":"","title":"Interface definition"},{"location":"Population_Module/#load-4d-mem-mapping-lesions-rois","text":"","title":"Load 4D Mem Mapping Lesions ROIs"},{"location":"Population_Module/#function_12","text":"function [x] = xASL_wrp_Load4DMemMapping_LesionsROIs(x)","title":"Function"},{"location":"Population_Module/#description_12","text":"Part of ExploreASL analysis module. Loads data & maps it to memory mapping file on disc, if not done before.","title":"Description"},{"location":"Population_Module/#workflow_12","text":"","title":"Workflow"},{"location":"Population_Module/#recommended-usage_12","text":"","title":"Recommended usage"},{"location":"Population_Module/#interface-definition_12","text":"","title":"Interface definition"},{"location":"Requirements/","text":"ExploreASL Requirements Matlab Version Docker Version","title":"Requirements"},{"location":"Requirements/#exploreasl-requirements","text":"","title":"ExploreASL Requirements"},{"location":"Requirements/#matlab-version","text":"","title":"Matlab Version"},{"location":"Requirements/#docker-version","text":"","title":"Docker Version"},{"location":"Structural_Module/","text":"Submodules of the Structural Module Clean Up WMH SEGM Function function xASL_wrp_CleanUpWMH_SEGM(x) Description Submodule of ExploreASL Structural Module, that cleans up under- and over-segmentations of WMH SEGM . Workflow This submodule aims to clean up WMH under- or oversegmentations in a conservatively & robust way, i.e. erring on the side of caution. It uses input from the tissue class segmentation (e.g. CAT12 ) to repair the WMH segmentation (e.g. LST LPA/LGA or externally provided). Note that before running the tissue segmentation, the T1w was (conservatively) filled for WMH lesions. This function is not tested a lot, so mainly conservatively set up to improve the WMH volumetrics, rather than improve the registration. This submodule contains the following steps: Administration Correct pGM islands inside pWM : WMH can have an intensity similar to GM on the T1w , which erroneously classifies them as GM instead of WM(H) . The rule used here, is to define GM islands within the WM as clusters of pGM >0.05 for which 3 layers (dilations) have at least 95% pWM . For these islands, pGM is given 100% to pWM . 50% of pWM is given to pWMH (the pWMH/pNAWM distinction is made later in the pipeline, here still pWM=pWMH+pNAWM ). The reason is that not all low T1w intensities within the WM are WMH , we still expect some lacunes, perivascular (Virchow-Robin) spaces, which could be considered pNAWM rather than pWMH. Perform brainmasking & join masks Correct any WMH inside GM or CSF -> here we assume that CAT12 did a good segmentation job. If pGM is larger than pWM & larger than pWMH , we consider a voxel to be pGM and remove the pWMH. This effectively removes pWMH segmentation noise in the GM or CSF , it doesn't correct any significant misclassification of WMH in the GM or CSF . If the WMH segmentation does a significant misclassification (e.g. setting the pWMH inside GM or CSF to a probability higher than GM or CSF is by tissue segmentation), this is lesion filled after the WMH segmentation, on the T1w , hence the tissue segmentation won't have a chance to correct this. Fortunately, most oversegmentations in the GM/CSF have low pWMH , as WMH segmentation algorithms already perform a light tissue prior-based clean up themselves. Saving & file management Prepare visuals for visual QC & file management Recommended usage Interface definition FLAIR Biasfield Correction Function function xASL_wrp_FLAIR_BiasfieldCorrection(x) Description Submodule of ExploreASL Structural Module, that performs a biasfield correction on T1w & applies it on the FLAIR . Workflow This submodule performs a biasfield correction on T1w and applies it on FLAIR . This can be useful, when there are large lesions on the FLAIR that hamper capturing the biasfield nicely on the FLAIR itself. In such cases, the biasfield of the T1w might be easier to obtain and should be the same as the FLAIR , provided they are scanned in the same scan session (i.e.g same scanner, same coil). BE CAREFUL : this submodule assumes that the biasfields of the T1w and FLAIR are comparable, which is not the case when one of the two (or both) are already biasfield corrected. Recommended usage Interface definition Get Volumetrics Function function xASL_wrp_GetVolumetrics(x) Description Submodule of ExploreASL Structural Module, that obtains volumes from the tissue segmentations (& FLAIR WMH segmentations if they exist). Workflow This submodule computes the total volume for each of the tissue classes & stores them in a TSV file (per BIDS ). This is computed from the native space segmentation derivatives ( GM, WM & CSF ), from which the ICV & relative volumes can be calculated. This is performed for CAT12 or SPM12 (whichever was used), and optionally for a WMH_SEGM . Recommended usage Interface definition LST Segment FLAIR WMH Function function xASL_wrp_LST_Segment_FLAIR_WMH(x, rWMHPath, WMHsegmAlg) Description Submodule of ExploreASL Structural Module, that performs a biasfield correction on T1w & applies it on the FLAIR . Workflow This submodule runs the LST WMH segmentation, either with LGA or LPA . LPA is the default choice, it outperforms LGA a bit, depending on the image quality. These algorithms perform optimally with 3T images, with good contrast. Generally, LPA oversegments whereas LGA undersegments. The LPA oversegmentation is corrected in a later submodule. If a WMH_SEGM already existed, the LST is run quickly as dummy only, to be replaced by the original WMH_SEGM image. This function has the following parts: Reslice FLAIR (& WMH_SEGM , if exists) to T1w Define parameters for segmentation Run the segmentation Replace by already existing WMH_SEGM File management Remove NaNs from segmentations & fix image edges Recommended usage Interface definition LST T1w Lesion Filling WMH Function function xASL_wrp_LST_T1w_LesionFilling_WMH(x, rWMHPath) Description Submodule of ExploreASL Structural Module, that performs lesion filling on T1w based on WMH segmented on the FLAIR . Workflow This submodule runs the LST WMH -based T1w lesion filling, which should improve the registration & segmentation of the T1w by e.g. CAT12/SPM12 . The WMH can be either segmented in the previous submodule by LST LGA/LPGA or provided externally. Before lesion filling, we clean up the WMH segmentation, to make the lesion filling a bit more conservative. Sometimes the WMH segmentation oversegments inside the GM (as there can be hyperintensities on the FLAIR ) & we don't want to lesion-fill these on the T1w (which would turn their intensities in intensities similar to WM , leading to misclassifications by the T1w segmentation). Note that this is submodule only performs the lesion filling, and the clean up is also performed for the lesion filling only. A more thorough WMH clean up (for e.g. WMH volumetrics) is performed later in the Structural module, using also the results from the T1w segmentation. Note when changing the lesion filling here, LST lesion filling expects a probability map, doesnt work nicely with binary mask This function runs the following steps: File management Clean up the WMH segmentation used for lesion filling Run lesion filling Correction of too much/erronous lesion filling File management Recommended usage Interface definition Linear Reg FLAIR 2 T1w Function function xASL_wrp_LinearReg_FLAIR2T1w(x, bAutoACPC) Description Submodule of ExploreASL Structural Module, that aligns FLAIR with T1w . Workflow This submodule registers FLAIR linearly to the T1w . The same transformation is applied to all other related scans ( FLAIR -segmented lesions, WMH specifically or other lesions). This is required to enable the application of T1w derivatives (e.g. transformations to standard space, tissue segmentation) for FLAIR and vice versa (e.g. WMH lesion-filling). Recommended usage Interface definition Linear Reg T1w2MNI Function function xASL_wrp_LinearReg_T1w2MNI(x, bAutoACPC) Description Submodule of ExploreASL Structural Module, that aligns T1w with MNI . Workflow This submodule registers T1w linearly to the center of MNI space, a.k.a. ACPC alignment. The same transformation is applied to all other related scans ( ASL4D, M0, FLAIR, etc.). This facilitates MNI -based algorithms (e.g. SPM -based segmentation), and allows for visual QC with all images roughly in the same space. This submodule first clips high values that can bias the registration algorithm, then performs a center of mass-based ACPC alignment, and then several iterations of SPM coregistration. Assuming that this submodule is run at the start of ExploreASL, all NIfTI orientation matrices are restored before running the registration. Recommended usage Interface definition Resample 2 Standard Space Function function xASL_wrp_Resample2StandardSpace(x) Description Submodule of ExploreASL Structural Module, that resamples all structural images & derivatives. Workflow This submodule resamples all structural images & their derivatives to standard space. It uses the transformation fields that were obtained previously in the Structural module, concatenates all transformations into a single transformation (if not already done) & applies the transformation with a single interpolation (either trilinear for low quality or probability maps, or 2nd order B-spline). Finally, it computes the Jacobian determinants (i.e. the derivative of the transformation field) to obtain a map of the volumetric effects of the transformation. This Jacobian map is multiplied with the standard space resampled images, to restore their (local & global) total volume. The sum of volumes in native & standard space are compared as QC . This submodule is not only part of the structural module, but can be repeated when the transformation map is edited, e.g. after longitudinal registration or after creation of a group-wise template. Recommended usage Interface definition Segment T1w Function function [x] = xASL_wrp_SegmentT1w(x, SegmentSPM12) Description Submodule of ExploreASL Structural Module, that segments 3D T1 (or T2 ) scan. Workflow This submodule segments high resolution structural/anatomical scans into GM/WM/CSF /soft tissue/bone/air tissue classes. It will save GM/WM/CSF in native space, and the transformation from native to standard space. This transformation includes Geodesic Shooting/DARTEL for CAT12 . This submodule contains the following steps: Administration Extra segmentation options by Jan Petr Segmentation using CAT12 If CAT12 fails, it will be repeated with higher contrast, higher strength affine preprocessing & less biasfield regularization If CAT12 fails twice, it will be skipped & SPM12 will be run Segmentation using SPM12 File management CAT12 File management lesions Resample lesions to standard space For the lesion masking. MORE EXPLANATION NEEDED BY JAN Manage flowfields Smooth combination non-linear flowfield outside the lesion & uniform flowfield within the lesion File management Recommended usage Interface definition Visual QC Structural Function function xASL_wrp_VisualQC_Structural(x) Description Submodule of ExploreASL Structural Module, that performs several visualizations for . Workflow This submodule performs several visualizations for visual & quantitative QC . After initial admin It starts with the SPM UP parameters (courtesy of Cyril Pernet, his SPM UP scripts were made more robust & accurate by Jan & Henk, & are implemented here for T1w (& optionally FLAIR ). Then it performs a collection of visualizations Also repeated specifically for lesions & manually provided ROIs Finally, this contains a report of all missing raw & derivative files, in native & standard space, printing the NIfTI orientation matrix content before ( hdr.mat0 ) & after registrations ( hdr.mat ). The determinant of these matrices should be the same, otherwise LeftRight has flipped. This should also be the same across a group scanned at the same scanner. Then various other QC functions are called & all are summarized in a PDF report. Recommended usage Interface definition","title":"Module Structural"},{"location":"Structural_Module/#submodules-of-the-structural-module","text":"","title":"Submodules of the Structural Module"},{"location":"Structural_Module/#clean-up-wmh-segm","text":"","title":"Clean Up WMH SEGM"},{"location":"Structural_Module/#function","text":"function xASL_wrp_CleanUpWMH_SEGM(x)","title":"Function"},{"location":"Structural_Module/#description","text":"Submodule of ExploreASL Structural Module, that cleans up under- and over-segmentations of WMH SEGM .","title":"Description"},{"location":"Structural_Module/#workflow","text":"This submodule aims to clean up WMH under- or oversegmentations in a conservatively & robust way, i.e. erring on the side of caution. It uses input from the tissue class segmentation (e.g. CAT12 ) to repair the WMH segmentation (e.g. LST LPA/LGA or externally provided). Note that before running the tissue segmentation, the T1w was (conservatively) filled for WMH lesions. This function is not tested a lot, so mainly conservatively set up to improve the WMH volumetrics, rather than improve the registration. This submodule contains the following steps: Administration Correct pGM islands inside pWM : WMH can have an intensity similar to GM on the T1w , which erroneously classifies them as GM instead of WM(H) . The rule used here, is to define GM islands within the WM as clusters of pGM >0.05 for which 3 layers (dilations) have at least 95% pWM . For these islands, pGM is given 100% to pWM . 50% of pWM is given to pWMH (the pWMH/pNAWM distinction is made later in the pipeline, here still pWM=pWMH+pNAWM ). The reason is that not all low T1w intensities within the WM are WMH , we still expect some lacunes, perivascular (Virchow-Robin) spaces, which could be considered pNAWM rather than pWMH. Perform brainmasking & join masks Correct any WMH inside GM or CSF -> here we assume that CAT12 did a good segmentation job. If pGM is larger than pWM & larger than pWMH , we consider a voxel to be pGM and remove the pWMH. This effectively removes pWMH segmentation noise in the GM or CSF , it doesn't correct any significant misclassification of WMH in the GM or CSF . If the WMH segmentation does a significant misclassification (e.g. setting the pWMH inside GM or CSF to a probability higher than GM or CSF is by tissue segmentation), this is lesion filled after the WMH segmentation, on the T1w , hence the tissue segmentation won't have a chance to correct this. Fortunately, most oversegmentations in the GM/CSF have low pWMH , as WMH segmentation algorithms already perform a light tissue prior-based clean up themselves. Saving & file management Prepare visuals for visual QC & file management","title":"Workflow"},{"location":"Structural_Module/#recommended-usage","text":"","title":"Recommended usage"},{"location":"Structural_Module/#interface-definition","text":"","title":"Interface definition"},{"location":"Structural_Module/#flair-biasfield-correction","text":"","title":"FLAIR Biasfield Correction"},{"location":"Structural_Module/#function_1","text":"function xASL_wrp_FLAIR_BiasfieldCorrection(x)","title":"Function"},{"location":"Structural_Module/#description_1","text":"Submodule of ExploreASL Structural Module, that performs a biasfield correction on T1w & applies it on the FLAIR .","title":"Description"},{"location":"Structural_Module/#workflow_1","text":"This submodule performs a biasfield correction on T1w and applies it on FLAIR . This can be useful, when there are large lesions on the FLAIR that hamper capturing the biasfield nicely on the FLAIR itself. In such cases, the biasfield of the T1w might be easier to obtain and should be the same as the FLAIR , provided they are scanned in the same scan session (i.e.g same scanner, same coil). BE CAREFUL : this submodule assumes that the biasfields of the T1w and FLAIR are comparable, which is not the case when one of the two (or both) are already biasfield corrected.","title":"Workflow"},{"location":"Structural_Module/#recommended-usage_1","text":"","title":"Recommended usage"},{"location":"Structural_Module/#interface-definition_1","text":"","title":"Interface definition"},{"location":"Structural_Module/#get-volumetrics","text":"","title":"Get Volumetrics"},{"location":"Structural_Module/#function_2","text":"function xASL_wrp_GetVolumetrics(x)","title":"Function"},{"location":"Structural_Module/#description_2","text":"Submodule of ExploreASL Structural Module, that obtains volumes from the tissue segmentations (& FLAIR WMH segmentations if they exist).","title":"Description"},{"location":"Structural_Module/#workflow_2","text":"This submodule computes the total volume for each of the tissue classes & stores them in a TSV file (per BIDS ). This is computed from the native space segmentation derivatives ( GM, WM & CSF ), from which the ICV & relative volumes can be calculated. This is performed for CAT12 or SPM12 (whichever was used), and optionally for a WMH_SEGM .","title":"Workflow"},{"location":"Structural_Module/#recommended-usage_2","text":"","title":"Recommended usage"},{"location":"Structural_Module/#interface-definition_2","text":"","title":"Interface definition"},{"location":"Structural_Module/#lst-segment-flair-wmh","text":"","title":"LST Segment FLAIR WMH"},{"location":"Structural_Module/#function_3","text":"function xASL_wrp_LST_Segment_FLAIR_WMH(x, rWMHPath, WMHsegmAlg)","title":"Function"},{"location":"Structural_Module/#description_3","text":"Submodule of ExploreASL Structural Module, that performs a biasfield correction on T1w & applies it on the FLAIR .","title":"Description"},{"location":"Structural_Module/#workflow_3","text":"This submodule runs the LST WMH segmentation, either with LGA or LPA . LPA is the default choice, it outperforms LGA a bit, depending on the image quality. These algorithms perform optimally with 3T images, with good contrast. Generally, LPA oversegments whereas LGA undersegments. The LPA oversegmentation is corrected in a later submodule. If a WMH_SEGM already existed, the LST is run quickly as dummy only, to be replaced by the original WMH_SEGM image. This function has the following parts: Reslice FLAIR (& WMH_SEGM , if exists) to T1w Define parameters for segmentation Run the segmentation Replace by already existing WMH_SEGM File management Remove NaNs from segmentations & fix image edges","title":"Workflow"},{"location":"Structural_Module/#recommended-usage_3","text":"","title":"Recommended usage"},{"location":"Structural_Module/#interface-definition_3","text":"","title":"Interface definition"},{"location":"Structural_Module/#lst-t1w-lesion-filling-wmh","text":"","title":"LST T1w Lesion Filling WMH"},{"location":"Structural_Module/#function_4","text":"function xASL_wrp_LST_T1w_LesionFilling_WMH(x, rWMHPath)","title":"Function"},{"location":"Structural_Module/#description_4","text":"Submodule of ExploreASL Structural Module, that performs lesion filling on T1w based on WMH segmented on the FLAIR .","title":"Description"},{"location":"Structural_Module/#workflow_4","text":"This submodule runs the LST WMH -based T1w lesion filling, which should improve the registration & segmentation of the T1w by e.g. CAT12/SPM12 . The WMH can be either segmented in the previous submodule by LST LGA/LPGA or provided externally. Before lesion filling, we clean up the WMH segmentation, to make the lesion filling a bit more conservative. Sometimes the WMH segmentation oversegments inside the GM (as there can be hyperintensities on the FLAIR ) & we don't want to lesion-fill these on the T1w (which would turn their intensities in intensities similar to WM , leading to misclassifications by the T1w segmentation). Note that this is submodule only performs the lesion filling, and the clean up is also performed for the lesion filling only. A more thorough WMH clean up (for e.g. WMH volumetrics) is performed later in the Structural module, using also the results from the T1w segmentation. Note when changing the lesion filling here, LST lesion filling expects a probability map, doesnt work nicely with binary mask This function runs the following steps: File management Clean up the WMH segmentation used for lesion filling Run lesion filling Correction of too much/erronous lesion filling File management","title":"Workflow"},{"location":"Structural_Module/#recommended-usage_4","text":"","title":"Recommended usage"},{"location":"Structural_Module/#interface-definition_4","text":"","title":"Interface definition"},{"location":"Structural_Module/#linear-reg-flair-2-t1w","text":"","title":"Linear Reg FLAIR 2 T1w"},{"location":"Structural_Module/#function_5","text":"function xASL_wrp_LinearReg_FLAIR2T1w(x, bAutoACPC)","title":"Function"},{"location":"Structural_Module/#description_5","text":"Submodule of ExploreASL Structural Module, that aligns FLAIR with T1w .","title":"Description"},{"location":"Structural_Module/#workflow_5","text":"This submodule registers FLAIR linearly to the T1w . The same transformation is applied to all other related scans ( FLAIR -segmented lesions, WMH specifically or other lesions). This is required to enable the application of T1w derivatives (e.g. transformations to standard space, tissue segmentation) for FLAIR and vice versa (e.g. WMH lesion-filling).","title":"Workflow"},{"location":"Structural_Module/#recommended-usage_5","text":"","title":"Recommended usage"},{"location":"Structural_Module/#interface-definition_5","text":"","title":"Interface definition"},{"location":"Structural_Module/#linear-reg-t1w2mni","text":"","title":"Linear Reg T1w2MNI"},{"location":"Structural_Module/#function_6","text":"function xASL_wrp_LinearReg_T1w2MNI(x, bAutoACPC)","title":"Function"},{"location":"Structural_Module/#description_6","text":"Submodule of ExploreASL Structural Module, that aligns T1w with MNI .","title":"Description"},{"location":"Structural_Module/#workflow_6","text":"This submodule registers T1w linearly to the center of MNI space, a.k.a. ACPC alignment. The same transformation is applied to all other related scans ( ASL4D, M0, FLAIR, etc.). This facilitates MNI -based algorithms (e.g. SPM -based segmentation), and allows for visual QC with all images roughly in the same space. This submodule first clips high values that can bias the registration algorithm, then performs a center of mass-based ACPC alignment, and then several iterations of SPM coregistration. Assuming that this submodule is run at the start of ExploreASL, all NIfTI orientation matrices are restored before running the registration.","title":"Workflow"},{"location":"Structural_Module/#recommended-usage_6","text":"","title":"Recommended usage"},{"location":"Structural_Module/#interface-definition_6","text":"","title":"Interface definition"},{"location":"Structural_Module/#resample-2-standard-space","text":"","title":"Resample 2 Standard Space"},{"location":"Structural_Module/#function_7","text":"function xASL_wrp_Resample2StandardSpace(x)","title":"Function"},{"location":"Structural_Module/#description_7","text":"Submodule of ExploreASL Structural Module, that resamples all structural images & derivatives.","title":"Description"},{"location":"Structural_Module/#workflow_7","text":"This submodule resamples all structural images & their derivatives to standard space. It uses the transformation fields that were obtained previously in the Structural module, concatenates all transformations into a single transformation (if not already done) & applies the transformation with a single interpolation (either trilinear for low quality or probability maps, or 2nd order B-spline). Finally, it computes the Jacobian determinants (i.e. the derivative of the transformation field) to obtain a map of the volumetric effects of the transformation. This Jacobian map is multiplied with the standard space resampled images, to restore their (local & global) total volume. The sum of volumes in native & standard space are compared as QC . This submodule is not only part of the structural module, but can be repeated when the transformation map is edited, e.g. after longitudinal registration or after creation of a group-wise template.","title":"Workflow"},{"location":"Structural_Module/#recommended-usage_7","text":"","title":"Recommended usage"},{"location":"Structural_Module/#interface-definition_7","text":"","title":"Interface definition"},{"location":"Structural_Module/#segment-t1w","text":"","title":"Segment T1w"},{"location":"Structural_Module/#function_8","text":"function [x] = xASL_wrp_SegmentT1w(x, SegmentSPM12)","title":"Function"},{"location":"Structural_Module/#description_8","text":"Submodule of ExploreASL Structural Module, that segments 3D T1 (or T2 ) scan.","title":"Description"},{"location":"Structural_Module/#workflow_8","text":"This submodule segments high resolution structural/anatomical scans into GM/WM/CSF /soft tissue/bone/air tissue classes. It will save GM/WM/CSF in native space, and the transformation from native to standard space. This transformation includes Geodesic Shooting/DARTEL for CAT12 . This submodule contains the following steps: Administration Extra segmentation options by Jan Petr Segmentation using CAT12 If CAT12 fails, it will be repeated with higher contrast, higher strength affine preprocessing & less biasfield regularization If CAT12 fails twice, it will be skipped & SPM12 will be run Segmentation using SPM12 File management CAT12 File management lesions Resample lesions to standard space For the lesion masking. MORE EXPLANATION NEEDED BY JAN Manage flowfields Smooth combination non-linear flowfield outside the lesion & uniform flowfield within the lesion File management","title":"Workflow"},{"location":"Structural_Module/#recommended-usage_8","text":"","title":"Recommended usage"},{"location":"Structural_Module/#interface-definition_8","text":"","title":"Interface definition"},{"location":"Structural_Module/#visual-qc-structural","text":"","title":"Visual QC Structural"},{"location":"Structural_Module/#function_9","text":"function xASL_wrp_VisualQC_Structural(x)","title":"Function"},{"location":"Structural_Module/#description_9","text":"Submodule of ExploreASL Structural Module, that performs several visualizations for .","title":"Description"},{"location":"Structural_Module/#workflow_9","text":"This submodule performs several visualizations for visual & quantitative QC . After initial admin It starts with the SPM UP parameters (courtesy of Cyril Pernet, his SPM UP scripts were made more robust & accurate by Jan & Henk, & are implemented here for T1w (& optionally FLAIR ). Then it performs a collection of visualizations Also repeated specifically for lesions & manually provided ROIs Finally, this contains a report of all missing raw & derivative files, in native & standard space, printing the NIfTI orientation matrix content before ( hdr.mat0 ) & after registrations ( hdr.mat ). The determinant of these matrices should be the same, otherwise LeftRight has flipped. This should also be the same across a group scanned at the same scanner. Then various other QC functions are called & all are summarized in a PDF report.","title":"Workflow"},{"location":"Structural_Module/#recommended-usage_9","text":"","title":"Recommended usage"},{"location":"Structural_Module/#interface-definition_9","text":"","title":"Interface definition"}]}